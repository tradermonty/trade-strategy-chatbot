# ğŸœ AIãŠã°ã‚ã¡ã‚ƒã‚“ã®ä½œã‚Šæ–¹ - åˆå¿ƒè€…ã§ã‚‚10åˆ†ã§ä½œã‚Œã‚‹ï¼RAGæ­è¼‰ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆç‰©èª

> ã€Œå­«ã‚ˆã€ä»Šæ—¥ã¯ãŠã°ã‚ã¡ã‚ƒã‚“ã®ç§˜å¯†ã®ãƒ¬ã‚·ãƒ”ã‚’æ•™ãˆã¦ã‚ã’ã‚‹ã‚ã€‚ã§ã‚‚ã€ã“ã‚Œã¯æ–™ç†ã®ãƒ¬ã‚·ãƒ”ã˜ã‚ƒãªã„ã®ã€‚AIã®ãƒ¬ã‚·ãƒ”ã‚ˆã€‚ã€

## ğŸ“– ç›®æ¬¡

1. [ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ï¼šAIãŠã°ã‚ã¡ã‚ƒã‚“ã¨ã®å‡ºä¼šã„](#ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ï¼šAIãŠã°ã‚ã¡ã‚ƒã‚“ã¨ã®å‡ºä¼šã„)
2. [ç¬¬1ç« ï¼šRAGã£ã¦ä½•ï¼Ÿä¸æ€è­°ãªæŠ€è¡“ã®æ­£ä½“](#ç¬¬1ç« ï¼šRAGã£ã¦ä½•ï¼Ÿä¸æ€è­°ãªæŠ€è¡“ã®æ­£ä½“)
3. [ç¬¬2ç« ï¼šææ–™ã‚’æº–å‚™ã—ã‚ˆã† - é–‹ç™ºç’°å¢ƒæ§‹ç¯‰](#ç¬¬2ç« ï¼šææ–™ã‚’æº–å‚™ã—ã‚ˆã†---é–‹ç™ºç’°å¢ƒæ§‹ç¯‰)
4. [ç¬¬3ç« ï¼šçŸ¥è­˜ã®ç¨®ã‚’ã¾ã - çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰](#ç¬¬3ç« ï¼šçŸ¥è­˜ã®ç¨®ã‚’ã¾ã---çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰)
5. [ç¬¬4ç« ï¼šè¨˜æ†¶ã®é­”æ³• - ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã®ç§˜å¯†](#ç¬¬4ç« ï¼šè¨˜æ†¶ã®é­”æ³•---ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã®ç§˜å¯†)
6. [ç¬¬5ç« ï¼šä¼šè©±ã®å¿ƒè‡“ - APIã‚µãƒ¼ãƒãƒ¼ã®å®Ÿè£…](#ç¬¬5ç« ï¼šä¼šè©±ã®å¿ƒè‡“---APIã‚µãƒ¼ãƒãƒ¼ã®å®Ÿè£…)
7. [ç¬¬6ç« ï¼šç¾ã—ã„é¡” - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä½œæˆ](#ç¬¬6ç« ï¼šç¾ã—ã„é¡”---ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä½œæˆ)
8. [ç¬¬7ç« ï¼šé­”æ³•ã®å®Œæˆ - å‹•ä½œç¢ºèªã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º](#ç¬¬7ç« ï¼šé­”æ³•ã®å®Œæˆ---å‹•ä½œç¢ºèªã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º)
9. [ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°ï¼šã‚ãªãŸã®ç•ªã§ã™](#ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°ï¼šã‚ãªãŸã®ç•ªã§ã™)

---

## ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ï¼šAIãŠã°ã‚ã¡ã‚ƒã‚“ã¨ã®å‡ºä¼šã„

ç”°ä¸­å¤ªéƒï¼ˆä»®åï¼‰ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’å­¦ã³å§‹ã‚ãŸã°ã‹ã‚Šã®å¤§å­¦ç”Ÿã€‚ã€Œæœ€è¿‘AIãŒã™ã”ã„ã£ã¦èãã‘ã©ã€è‡ªåˆ†ã§ã‚‚ä½œã‚Œã‚‹ã®ã‹ãªï¼Ÿã€ã¨æ€ã£ã¦ã„ãŸçŸ¢å…ˆã€å‹äººã‹ã‚‰ä¸æ€è­°ãªè©±ã‚’èã„ãŸã€‚

ã€ŒãŠã°ã‚ã¡ã‚ƒã‚“ã®æ–™ç†ãƒ¬ã‚·ãƒ”ã‚’å…¨éƒ¨è¦šãˆã¦ãã‚Œã‚‹AIãŒã‚ã‚‹ã‚“ã ã£ã¦ï¼ã—ã‹ã‚‚ã€10åˆ†ã§ä½œã‚Œã‚‹ã‚‰ã—ã„ã‚ˆã€

èˆˆå‘³æ´¥ã€…ã®å¤ªéƒã¯ã€ãã®ã€ŒAIãŠã°ã‚ã¡ã‚ƒã‚“ã€ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚

```bash
git clone https://github.com/takusaotome/rag-starter-kit.git
cd rag-starter-kit
```

ã€Œã“ã‚ŒãŒã€AIãŠã°ã‚ã¡ã‚ƒã‚“ã®è¨­è¨ˆå›³...ï¼Ÿã€

---

## ç¬¬1ç« ï¼šRAGã£ã¦ä½•ï¼Ÿä¸æ€è­°ãªæŠ€è¡“ã®æ­£ä½“

### ğŸ¤– AIãŠã°ã‚ã¡ã‚ƒã‚“ãŒæ•™ãˆã‚‹ã€ŒRAGã®åŸºæœ¬ã€

å¤ªéƒãŒã‚³ãƒ¼ãƒ‰ã‚’çœºã‚ã¦ã„ã‚‹ã¨ã€çªç„¶ç”»é¢ã®ä¸­ã‹ã‚‰ã‚„ã•ã—ã„å£°ãŒèã“ãˆã¦ããŸã€‚

ã€Œã“ã‚“ã«ã¡ã¯ã€å¤ªéƒãã‚“ã€‚ç§ãŒAIãŠã°ã‚ã¡ã‚ƒã‚“ã‚ˆã€‚ä»Šæ—¥ã¯ã€RAGã¨ã„ã†ä¸æ€è­°ãªæŠ€è¡“ã«ã¤ã„ã¦æ•™ãˆã¦ã‚ã’ã‚‹ã‚ã€‚ã€

**RAGï¼ˆRetrieval-Augmented Generationï¼‰**ã¨ã¯ã€æ—¥æœ¬èªã§ã€Œæ¤œç´¢æ‹¡å¼µç”Ÿæˆã€ã¨ã„ã†æ„å‘³ã€‚

### ğŸ§  æ™®é€šã®AIã¨RAGæ­è¼‰AIã®é•ã„

**æ™®é€šã®AIï¼ˆGPT-4ãªã©ï¼‰**
```
è³ªå•: "è¦ªå­ä¸¼ã®ä½œã‚Šæ–¹æ•™ãˆã¦"
â†“
AI: "ä¸€èˆ¬çš„ãªè¦ªå­ä¸¼ã®ä½œã‚Šæ–¹ã¯..."
```

**RAGæ­è¼‰AIï¼ˆAIãŠã°ã‚ã¡ã‚ƒã‚“ï¼‰**
```
è³ªå•: "è¦ªå­ä¸¼ã®ä½œã‚Šæ–¹æ•™ãˆã¦"
â†“
â‘  çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‹ã‚‰é–¢é€£æƒ…å ±ã‚’æ¤œç´¢
â‘¡ è¦‹ã¤ã‘ãŸæƒ…å ± + è³ªå•ã‚’çµ„ã¿åˆã‚ã›
â‘¢ ã‚ˆã‚Šæ­£ç¢ºã§è©³ç´°ãªå›ç­”ã‚’ç”Ÿæˆ
â†“
AI: "ãŠã°ã‚ã¡ã‚ƒã‚“ã®ç§˜ä¼ãƒ¬ã‚·ãƒ”ã«ã‚ˆã‚‹ã¨ã€è¦ªå­ä¸¼ã®ç¾å‘³ã—ã•ã®ç§˜å¯†ã¯..."
```

### ğŸ” RAGã®é­”æ³•ã®ä»•çµ„ã¿

```mermaid
graph TD
    A[ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•] --> B[é¡ä¼¼åº¦æ¤œç´¢]
    B --> C[çŸ¥è­˜ãƒ™ãƒ¼ã‚¹]
    C --> D[é–¢é€£æƒ…å ±å–å¾—]
    D --> E[ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ]
    E --> F[LLMæ¨è«–]
    F --> G[å›ç­”ç”Ÿæˆ]
```

ã€Œã¤ã¾ã‚Šã€RAGã¯AIã«ã€å°‚é–€çš„ãªè¨˜æ†¶ã€ã‚’æŒãŸã›ã‚‹æŠ€è¡“ãªã®ã‚ˆã€‚ãŠã°ã‚ã¡ã‚ƒã‚“ã®æ–™ç†ãƒ¬ã‚·ãƒ”ã‚’è¦šãˆã•ã›ã‚Œã°ã€æ–™ç†ã®å°‚é–€å®¶ã«ãªã‚Œã‚‹ã®ï¼ã€

---

## ç¬¬2ç« ï¼šææ–™ã‚’æº–å‚™ã—ã‚ˆã† - é–‹ç™ºç’°å¢ƒæ§‹ç¯‰

### ğŸ› ï¸ å¿…è¦ãªææ–™ï¼ˆæŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼‰

AIãŠã°ã‚ã¡ã‚ƒã‚“ã®ãƒ¬ã‚·ãƒ”ã«ã¯ã€ä»¥ä¸‹ã®ææ–™ãŒå¿…è¦ï¼š

```python
# ğŸ³ èª¿ç†å™¨å…·ï¼ˆãƒ¡ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼‰
FastAPI      # é«˜é€ŸAPIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
LangChain    # AIé–‹ç™ºãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
OpenAI       # å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«

# ğŸ§  è¨˜æ†¶è£…ç½®ï¼ˆãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ï¼‰
FAISS        # é«˜é€Ÿé¡ä¼¼åº¦æ¤œç´¢
OpenAI Embeddings  # ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ™ã‚¯ãƒˆãƒ«åŒ–

# ğŸ¨ ãã®ä»–ã®èª¿å‘³æ–™
JWT          # èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
Pydantic     # ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
Uvicorn      # ASGIã‚µãƒ¼ãƒãƒ¼
```

### ğŸ“¦ ç’°å¢ƒæ§‹ç¯‰ã®æ‰‹é †

```bash
# 1. ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆï¼ˆæ–™ç†ã§è¨€ã†ã€Œæ¸…æ½”ãªèª¿ç†å ´ã€ï¼‰
python3 -m venv venv
source venv/bin/activate  # Windowsã®å ´åˆ: venv\Scripts\activate

# 2. ææ–™ã‚’èª¿é”ï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼‰
pip install -r requirements.txt

# 3. ç§˜å¯†ã®èª¿å‘³æ–™ã‚’æº–å‚™ï¼ˆAPI Keyè¨­å®šï¼‰
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
echo "OPENAI_API_KEY=your-api-key-here" > .env
echo "JWT_SECRET_KEY=your-secret-key" >> .env
```

**ğŸ’¡ åˆå¿ƒè€…å‘ã‘Tips**

- **ä»®æƒ³ç’°å¢ƒã£ã¦ä½•ï¼Ÿ**: æ–™ç†ã§ä¾‹ãˆã‚‹ã¨ã€Œå°‚ç”¨ã®èª¿ç†å ´ã€ã€‚ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ææ–™ãŒæ··ã–ã‚‰ãªã„ã‚ˆã†ã«éš”é›¢ã™ã‚‹æŠ€è¡“
- **API Keyã£ã¦ï¼Ÿ**: OpenAIã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†ãŸã‚ã®ã€Œå…¥å ´åˆ¸ã€ã€‚[OpenAIå…¬å¼ã‚µã‚¤ãƒˆ](https://openai.com/)ã§å–å¾—å¯èƒ½

---

## ç¬¬3ç« ï¼šçŸ¥è­˜ã®ç¨®ã‚’ã¾ã - çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰

### ğŸ“š ãŠã°ã‚ã¡ã‚ƒã‚“ã®çŸ¥è­˜ãƒ™ãƒ¼ã‚¹

å¤ªéƒã¯`knowledge`ãƒ•ã‚©ãƒ«ãƒ€ã‚’è¦—ã„ã¦ã¿ãŸã€‚

```bash
ls knowledge/
# 01_basic_rice_dishes.md
# 02_noodle_dishes.md
# 03_grilled_dishes.md
# ...
```

ã€Œã‚ã‚ã€æœ¬å½“ã«ãŠã°ã‚ã¡ã‚ƒã‚“ã®ãƒ¬ã‚·ãƒ”ãŒã„ã£ã±ã„ï¼ã€

### ğŸœ çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã®ä¸­èº«ã‚’è¦‹ã¦ã¿ã‚ˆã†

```markdown
# åŸºæœ¬ã®ã”é£¯ã‚‚ã® - Basic Rice Dishes

## è¦ªå­ä¸¼ (Oyakodon - Chicken and Egg Rice Bowl)

### ç”±æ¥ãƒ»æ–‡åŒ–çš„èƒŒæ™¯
è¦ªå­ä¸¼ã¯æ˜æ²»æ™‚ä»£ã«æ±äº¬ã§ç”Ÿã¾ã‚ŒãŸæ–™ç†ã§ã€
é¶è‚‰ï¼ˆè¦ªï¼‰ã¨åµï¼ˆå­ï¼‰ã‚’ä½¿ã†ã“ã¨ã‹ã‚‰ã€Œè¦ªå­ä¸¼ã€ã¨åä»˜ã‘ã‚‰ã‚Œã¾ã—ãŸã€‚

### ææ–™ï¼ˆ2äººåˆ†ï¼‰
- é¶ã‚‚ã‚‚è‚‰: 200gï¼ˆä¸€å£å¤§ã«ã‚«ãƒƒãƒˆï¼‰
- åµ: 4å€‹
- ç‰ã­ã: 1/2å€‹ï¼ˆè–„åˆ‡ã‚Šï¼‰
...

### èª¿ç†ã®ã‚³ãƒ„
- **åµã¯åŠç†ŸãŒç¾å‘³**: å®Œå…¨ã«å›ºã‚ãšã€ã¨ã‚ã¨ã‚ã®åŠç†ŸçŠ¶æ…‹ã§ä»•ä¸Šã’ã‚‹
- **ç«åŠ æ¸›ãŒé‡è¦**: å¼·ç«ã ã¨åµãŒå›ºããªã‚Šã™ãã‚‹ã®ã§ä¸­ç«ã§èª¿ç†
...
```

### ğŸ”§ ã‚ãªãŸã®çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‚’ä½œã‚‹æ–¹æ³•

**Step 1: æ—¢å­˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚è€ƒã«ã—ã‚ˆã†**

```bash
# ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚·ãƒ”ã‚’ç¢ºèª
cat knowledge/01_basic_rice_dishes.md
```

**Step 2: è‡ªåˆ†ã®å°‚é–€åˆ†é‡ã®çŸ¥è­˜ã‚’è¿½åŠ **

```markdown
# ä¾‹: ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°çŸ¥è­˜ãƒ™ãƒ¼ã‚¹
## PythonåŸºç¤

### å¤‰æ•°ã®å®£è¨€
name = "å¤ªéƒ"
age = 20

### é–¢æ•°ã®å®šç¾©
def greet(name):
    return f"ã“ã‚“ã«ã¡ã¯ã€{name}ã•ã‚“ï¼"
```

**Step 3: æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å¿ƒãŒã‘ã‚ˆã†**

```markdown
# è‰¯ã„ä¾‹
## è¦‹å‡ºã—
### æ¦‚è¦
### è©³ç´°æ‰‹é †
### æ³¨æ„ç‚¹

# æ‚ªã„ä¾‹
é©å½“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’ç¾…åˆ—...
```

---

## ç¬¬4ç« ï¼šè¨˜æ†¶ã®é­”æ³• - ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã®ç§˜å¯†

### ğŸ§  AIã®è¨˜æ†¶ã®ä»•çµ„ã¿

ã€Œå¤ªéƒãã‚“ã€AIã®è¨˜æ†¶ã£ã¦äººé–“ã¨ã¯é•ã†ã®ã‚ˆã€ã¨AIãŠã°ã‚ã¡ã‚ƒã‚“ãŒèª¬æ˜ã—ã¦ãã‚ŒãŸã€‚

**äººé–“ã®è¨˜æ†¶**
- æ–‡å­—ã¨ã—ã¦è¦šãˆã‚‹
- æ„å‘³ã§æ€ã„å‡ºã™
- æ›–æ˜§ã§æ„Ÿæƒ…çš„

**AIã®è¨˜æ†¶ï¼ˆãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ï¼‰**
- æ•°å€¤ã®é…åˆ—ã¨ã—ã¦è¦šãˆã‚‹
- æ•°å­¦çš„é¡ä¼¼åº¦ã§æ¤œç´¢
- æ­£ç¢ºã§å®¢è¦³çš„

### ğŸ”¢ ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã®é­”æ³•

```python
# æ–‡ç« ãŒãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã•ã‚Œã‚‹æ§˜å­
"è¦ªå­ä¸¼ã®ä½œã‚Šæ–¹" â†’ [0.1, -0.3, 0.8, 0.2, ...]
"é¶è‚‰ã¨åµã®æ–™ç†" â†’ [0.2, -0.2, 0.7, 0.3, ...]
```

é¡ä¼¼åº¦ã®è¨ˆç®—ï¼š
```python
similarity = cosine_similarity(vector1, vector2)
# 0.85ï¼ˆã¨ã¦ã‚‚ä¼¼ã¦ã„ã‚‹ï¼‰
```

### ğŸ—ï¸ ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã‚’æ§‹ç¯‰ã—ã‚ˆã†

```bash
# çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‚’ãƒ™ã‚¯ãƒˆãƒ«åŒ–
python3 run_etl.py
```

å®Ÿè¡Œã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªé­”æ³•ãŒèµ·ã“ã‚‹ï¼š

```python
# ingest.py ã®ä¸­èº«ï¼ˆç°¡ç•¥ç‰ˆï¼‰
def process_documents():
    # 1. ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿
    documents = load_markdown_files("knowledge/")
    
    # 2. æ–‡ç« ã‚’é©åˆ‡ãªé•·ã•ã«åˆ†å‰²
    text_chunks = split_into_chunks(documents, chunk_size=800)
    
    # 3. å„ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›
    embeddings = OpenAIEmbeddings()
    vectors = embeddings.embed_documents(text_chunks)
    
    # 4. é«˜é€Ÿæ¤œç´¢å¯èƒ½ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆ
    vector_store = FAISS.from_documents(text_chunks, embeddings)
    
    # 5. ä¿å­˜
    vector_store.save_local("vector_store")
```

**ğŸ’¡ åˆå¿ƒè€…å‘ã‘Tips**

- **ãƒãƒ£ãƒ³ã‚¯ã£ã¦ä½•ï¼Ÿ**: é•·ã„æ–‡ç« ã‚’é©åˆ‡ãªé•·ã•ã«åˆ†å‰²ã—ãŸã‚‚ã®ã€‚æ–™ç†ã§è¨€ã†ã¨ã€Œä¸€å£å¤§ã«åˆ‡ã‚‹ã€
- **ãªãœåˆ†å‰²ã™ã‚‹ã®ï¼Ÿ**: AIãŒç†è§£ã—ã‚„ã™ãã€æ¤œç´¢ç²¾åº¦ãŒå‘ä¸Šã™ã‚‹
- **ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒæ•°**: OpenAIã®`text-embedding-3-small`ã¯1536æ¬¡å…ƒï¼ˆ1536å€‹ã®æ•°å€¤ï¼‰

---

## ç¬¬5ç« ï¼šä¼šè©±ã®å¿ƒè‡“ - APIã‚µãƒ¼ãƒãƒ¼ã®å®Ÿè£…

### ğŸš€ FastAPIã‚µãƒ¼ãƒãƒ¼ã®æ§‹é€ 

```python
# server.py ã®ä¸»è¦éƒ¨åˆ†
from fastapi import FastAPI, HTTPException, Depends
from langchain.chains import RetrievalQA
from langchain_openai import ChatOpenAI

class RAGServer:
    def __init__(self):
        self.vector_store = None
        self.qa_chain = None
        self.embeddings = OpenAIEmbeddings()
    
    def process_query(self, query: str):
        # 1. è³ªå•ã‚’å—ã‘å–ã‚‹
        # 2. é–¢é€£æƒ…å ±ã‚’æ¤œç´¢
        # 3. LLMã§å›ç­”ç”Ÿæˆ
        # 4. çµæœã‚’è¿”ã™
        pass
```

### ğŸ” è¨€èªæ¤œå‡ºã®é­”æ³•

ãŠã°ã‚ã¡ã‚ƒã‚“ã¯å¤šå›½èªå¯¾å¿œï¼

```python
def detect_language(self, text: str) -> str:
    """è³ªå•ã®è¨€èªã‚’è‡ªå‹•æ¤œå‡º"""
    try:
        detected_lang = detect(text)
        if detected_lang == 'ja':
            return 'japanese'
        elif detected_lang == 'en':
            return 'english'
        else:
            return 'english'  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
    except:
        return 'english'
```

### ğŸŒŠ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ©Ÿèƒ½

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å›ç­”ãŒæµã‚Œã‚‹ä»•çµ„ã¿ï¼š

```python
async def process_query_streaming(self, query: str):
    """ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å½¢å¼ã§å›ç­”ã‚’ç”Ÿæˆ"""
    # è¨€èªæ¤œå‡º
    language = self.detect_language(query)
    
    # å‹•çš„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
    prompt = self.get_dynamic_prompt_template(query)
    
    # ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é–‹å§‹
    async for chunk in self.streaming_qa_chain.astream({"query": query}):
        yield f"data: {json.dumps({'text': chunk.get('result', '')})}\n\n"
```

### ğŸ” èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 

```python
# JWTèªè¨¼
def create_access_token(data: dict) -> str:
    to_encode = data.copy()
    expire = datetime.utcnow() + timedelta(hours=24)
    to_encode.update({"exp": expire})
    return jwt.encode(to_encode, Config.JWT_SECRET_KEY, algorithm="HS256")
```

---

## ç¬¬6ç« ï¼šç¾ã—ã„é¡” - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä½œæˆ

### ğŸ¨ Tailwind CSSã§ç¾ã—ã„UI

```html
<!-- RAG_demo.html ã®æŠœç²‹ -->
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
    <div class="max-w-4xl mx-auto p-6">
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 px-8 py-6">
                <h1 class="text-3xl font-bold text-white">
                    ğŸœ RAG Starter Kit Demo
                </h1>
            </div>
        </div>
    </div>
</div>
```

### âŒ¨ï¸ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ

```javascript
// Cmd+Enter / Ctrl+Enter ã§ã‚¯ã‚¨ãƒªå®Ÿè¡Œ
document.addEventListener('keydown', function(e) {
    if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') {
        e.preventDefault();
        if (!submitButton.disabled) {
            submitQuery();
        }
    }
});
```

### ğŸ’« ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¿œç­”è¡¨ç¤º

```javascript
// Server-Sent Events ã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
const eventSource = new EventSource('/query/stream', {
    method: 'POST',
    headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
    }
});

eventSource.onmessage = function(event) {
    const data = JSON.parse(event.data);
    responseDiv.innerHTML += data.text;
};
```

---

## ç¬¬7ç« ï¼šé­”æ³•ã®å®Œæˆ - å‹•ä½œç¢ºèªã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ğŸ¯ AIãŠã°ã‚ã¡ã‚ƒã‚“ã‚’èµ·å‹•ã—ã¦ã¿ã‚ˆã†

å¤ªéƒã¯ã€ã¤ã„ã«å®Œæˆã—ãŸRAGã‚·ã‚¹ãƒ†ãƒ ã‚’å‹•ã‹ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚

ã€Œã§ã‚‚ã€ã©ã†ã‚„ã£ã¦èµ·å‹•ã™ã‚‹ã®ï¼Ÿã€å¤ªéƒã¯å°‘ã—ä¸å®‰ã«ãªã£ãŸã€‚

ã€Œå¤§ä¸ˆå¤«ã‚ˆã€å¤ªéƒãã‚“ã€‚ä¸€æ­©ãšã¤é€²ã‚ã¾ã—ã‚‡ã†ã€AIãŠã°ã‚ã¡ã‚ƒã‚“ãŒå„ªã—ãæ•™ãˆã¦ãã‚ŒãŸã€‚

#### ğŸ“¦ 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã¾ãšã€å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```bash
# 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt
```

**ğŸ’¡ ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã®ï¼Ÿ**
- `requirements.txt`ã«æ›¸ã‹ã‚ŒãŸã™ã¹ã¦ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä¸€åº¦ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- LangChainã€FastAPIã€OpenAIãªã©ã®å¿…è¦ãªãƒ„ãƒ¼ãƒ«ãŒæƒã†
- ä»®æƒ³ç’°å¢ƒå†…ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ãŸã‚ã€ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å½±éŸ¿ã—ãªã„

**ğŸš¨ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ³•ï¼š**
```bash
# ã‚¨ãƒ©ãƒ¼ï¼špip: command not found
# è§£æ±ºæ³•ï¼šPythonãŒæ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
python3 -m pip install -r requirements.txt

# ã‚¨ãƒ©ãƒ¼ï¼špermission denied
# è§£æ±ºæ³•ï¼šä»®æƒ³ç’°å¢ƒã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€--userãƒ•ãƒ©ã‚°ã‚’è¿½åŠ 
pip install --user -r requirements.txt
```

#### ğŸ”‘ 2. ç’°å¢ƒå¤‰æ•°è¨­å®š

OpenAI APIã‚­ãƒ¼ã‚’è¨­å®šã—ã¾ã™ã€‚

```bash
# 2. ç’°å¢ƒå¤‰æ•°è¨­å®š
export OPENAI_API_KEY="your-api-key-here"
```

**ğŸ’¡ ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã®ï¼Ÿ**
- OpenAI APIã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®èªè¨¼æƒ…å ±ã‚’è¨­å®š
- ã€Œyour-api-key-hereã€ã‚’å®Ÿéš›ã®APIã‚­ãƒ¼ã«ç½®ãæ›ãˆã‚‹
- ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦è¨­å®šã™ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰å†…ã«ç›´æ¥æ›¸ã‹ãšã«æ¸ˆã‚€

**ğŸ”§ å®Ÿéš›ã®è¨­å®šæ–¹æ³•ï¼š**
```bash
# å®Ÿéš›ã®APIã‚­ãƒ¼ã‚’è¨­å®šï¼ˆä¾‹ï¼‰
export OPENAI_API_KEY="sk-1234567890abcdefghijklmnopqrstuvwxyz"

# è¨­å®šç¢ºèª
echo $OPENAI_API_KEY
```

**ğŸš¨ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„ç‚¹ï¼š**
- APIã‚­ãƒ¼ã¯çµ¶å¯¾ã«å…¬é–‹ã—ãªã„
- `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¦ã€`.gitignore`ã«è¿½åŠ ã™ã‚‹
- å®šæœŸçš„ã«ã‚­ãƒ¼ã‚’å†ç”Ÿæˆã™ã‚‹

#### ğŸ—‚ï¸ 3. ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢æ§‹ç¯‰

ãƒ¬ã‚·ãƒ”æƒ…å ±ã‚’ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã—ã¦æ¤œç´¢å¯èƒ½ã«ã—ã¾ã™ã€‚

```bash
# 3. ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢æ§‹ç¯‰
python3 run_etl.py
```

**ğŸ’¡ ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã®ï¼Ÿ**
- `knowledge/`ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿
- ãƒ†ã‚­ã‚¹ãƒˆã‚’å°ã•ãªãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²
- å„ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆæ•°å€¤ã®é…åˆ—ï¼‰ã«å¤‰æ›
- FAISSãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã«ä¿å­˜ã—ã¦é«˜é€Ÿæ¤œç´¢ã‚’å¯èƒ½ã«ã™ã‚‹

**ğŸ“Š å®Ÿè¡Œæ™‚ã®å‡ºåŠ›ä¾‹ï¼š**
```
ğŸ“š Processing knowledge files...
âœ… Loaded 01_basic_rice_dishes.md (1,234 characters)
âœ… Loaded 02_noodle_dishes.md (2,345 characters)
ğŸ”„ Creating vector embeddings...
âœ… Vector store created successfully!
ğŸ’¾ Saved to vector_store/ directory
```

**ğŸš¨ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ³•ï¼š**
```bash
# ã‚¨ãƒ©ãƒ¼ï¼šNo such file or directory: 'knowledge'
# è§£æ±ºæ³•ï¼šknowledgeãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
ls -la knowledge/

# ã‚¨ãƒ©ãƒ¼ï¼šOpenAI API key not set
# è§£æ±ºæ³•ï¼šç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
echo $OPENAI_API_KEY

# ã‚¨ãƒ©ãƒ¼ï¼šRate limit exceeded
# è§£æ±ºæ³•ï¼šå°‘ã—å¾…ã£ã¦ã‹ã‚‰å†å®Ÿè¡Œ
sleep 60 && python3 run_etl.py
```

#### ğŸš€ 4. ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

RAGã‚·ã‚¹ãƒ†ãƒ ã®Webã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ã€‚

```bash
# 4. ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
python3 server.py
```

**ğŸ’¡ ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã®ï¼Ÿ**
- FastAPIã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
- ãƒãƒ¼ãƒˆ8000ã§HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘
- ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã‚’èª­ã¿è¾¼ã¿ã€è³ªå•å¿œç­”ã®æº–å‚™å®Œäº†
- ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªçŠ¶æ…‹ã«ãªã‚‹

**ğŸ“Š æ­£å¸¸èµ·å‹•æ™‚ã®å‡ºåŠ›ï¼š**
```
ğŸš€ RAG Starter Kit Server starting...
ğŸ“ Loading prompt template...
âœ… Loaded prompt template
ğŸ“š Loading vector store...
âœ… Vector store loading completed.
ğŸ”— Setting up QA chain...
âœ… QA chain setup completed.
ğŸš€ RAG server initialization completed!
INFO:     Uvicorn running on http://0.0.0.0:8000
```

**ğŸš¨ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ³•ï¼š**
```bash
# ã‚¨ãƒ©ãƒ¼ï¼šAddress already in use
# è§£æ±ºæ³•ï¼šãƒãƒ¼ãƒˆãŒä½¿ç”¨ä¸­ã®å ´åˆã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
lsof -ti:8000 | xargs kill -9

# ã‚¨ãƒ©ãƒ¼ï¼šModuleNotFoundError
# è§£æ±ºæ³•ï¼šå¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„
pip install -r requirements.txt

# ã‚¨ãƒ©ãƒ¼ï¼šVector store not found
# è§£æ±ºæ³•ï¼šãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ãŒä½œæˆã•ã‚Œã¦ã„ãªã„
python3 run_etl.py
```

### ğŸŒ ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹

ã€Œå¤ªéƒãã‚“ã€ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ãŸã‚‰ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€

```bash
# ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸ã‚’é–‹ã
open http://localhost:8000/RAG_demo.html
```

**ğŸ’¡ ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã®ï¼Ÿ**
- ãƒ–ãƒ©ã‚¦ã‚¶ã§`http://localhost:8000/RAG_demo.html`ã‚’é–‹ã
- `localhost:8000`ã¯ã‚ãªãŸã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ä¸Šã§å‹•ã„ã¦ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼
- ç¾ã—ã„Web UIãŒè¡¨ç¤ºã•ã‚Œã‚‹

**ğŸ–¥ï¸ ç”»é¢ã®èª¬æ˜ï¼š**
1. **ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢** - ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼š`admin`ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼š`test123`
2. **è³ªå•å…¥åŠ›æ¬„** - ã“ã“ã«è³ªå•ã‚’å…¥åŠ›
3. **Submit ãƒœã‚¿ãƒ³** - è³ªå•ã‚’é€ä¿¡ï¼ˆEnterã‚­ãƒ¼ã§ã‚‚å¯ï¼‰
4. **å›ç­”è¡¨ç¤ºæ¬„** - AIãŠã°ã‚ã¡ã‚ƒã‚“ã®å›ç­”ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤º

**ğŸš¨ ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆï¼š**
```bash
# 1. ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
curl http://localhost:8000/health

# 2. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãŒåŸå› ã®å ´åˆ
# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
# http://127.0.0.1:8000/RAG_demo.html

# 3. ãƒãƒ¼ãƒˆãŒé•ã†å ´åˆ
# ã‚µãƒ¼ãƒãƒ¼ã®å‡ºåŠ›ã‚’ç¢ºèªã—ã¦ãƒãƒ¼ãƒˆç•ªå·ã‚’ç¢ºèª
```

### ğŸ³ å®Ÿéš›ã«è³ªå•ã—ã¦ã¿ã‚ˆã†

å¤ªéƒã¯ã€ãƒ‰ã‚­ãƒ‰ã‚­ã—ãªãŒã‚‰åˆã‚ã¦ã®è³ªå•ã‚’ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚

ã€Œã†ã¾ãç­”ãˆã¦ãã‚Œã‚‹ã‹ãªï¼Ÿã€

#### ğŸ“ æ—¥æœ¬èªã§ã®è³ªå•

**è³ªå•ä¾‹ï¼š**
```
è³ªå•: "è¦ªå­ä¸¼ã®ä½œã‚Šæ–¹ã‚’æ•™ãˆã¦"
```

**AIãŠã°ã‚ã¡ã‚ƒã‚“ã®å›ç­”ï¼š**
```
ãŠã°ã‚ã¡ã‚ƒã‚“ã®ç§˜ä¼ãƒ¬ã‚·ãƒ”ã«ã‚ˆã‚‹ã¨ã€è¦ªå­ä¸¼ã®ç¾å‘³ã—ã•ã®ç§˜å¯†ã¯ã€
é¶è‚‰ã¨åµã®çµ¶å¦™ãªãƒãƒ©ãƒ³ã‚¹ã«ã‚ã‚Šã¾ã™ã€‚

ğŸ“‹ ææ–™ï¼ˆ2äººåˆ†ï¼‰ï¼š
- é¶ã‚‚ã‚‚è‚‰ 200g
- åµ 4å€‹
- ç‰ã­ã 1/2å€‹
- ã ã—æ± 200ml
- é†¤æ²¹ å¤§ã•ã˜2
- ã¿ã‚Šã‚“ å¤§ã•ã˜2
- ç ‚ç³– å¤§ã•ã˜1

ğŸ‘©â€ğŸ³ ä½œã‚Šæ–¹ï¼š
1. é¶è‚‰ã¯ä¸€å£å¤§ã«åˆ‡ã‚Šã€ç‰ã­ãã¯è–„åˆ‡ã‚Šã«ã—ã¾ã™
2. ã ã—æ±ã€é†¤æ²¹ã€ã¿ã‚Šã‚“ã€ç ‚ç³–ã‚’é‹ã§ç…®ç«‹ã¦ã¾ã™
3. é¶è‚‰ã¨ç‰ã­ãã‚’åŠ ãˆã¦5åˆ†ç…®è¾¼ã¿ã¾ã™
...
```

**ğŸ’¡ ã“ã“ã§ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã®ï¼Ÿ**
1. è³ªå•ãŒæ—¥æœ¬èªã§å…¥åŠ›ã•ã‚Œã‚‹
2. ã‚·ã‚¹ãƒ†ãƒ ãŒæ—¥æœ¬èªã‚’æ¤œå‡º
3. ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã‹ã‚‰é–¢é€£ã™ã‚‹æ–™ç†æƒ…å ±ã‚’æ¤œç´¢
4. æ—¥æœ¬èªã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§GPT-4oã«è³ªå•
5. æ—¥æœ¬èªã§è‡ªç„¶ãªå›ç­”ã‚’ç”Ÿæˆ

#### ğŸŒ è‹±èªã§ã®è³ªå•

**è³ªå•ä¾‹ï¼š**
```
Question: "How to make Oyakodon?"
```

**AIãŠã°ã‚ã¡ã‚ƒã‚“ã®å›ç­”ï¼š**
```
According to the traditional recipe, the secret of delicious Oyakodon
lies in the perfect balance of chicken and eggs.

ğŸ“‹ Ingredients (serves 2):
- 200g chicken thigh meat
- 4 eggs
- 1/2 onion
- 200ml dashi stock
- 2 tbsp soy sauce
- 2 tbsp mirin
- 1 tbsp sugar

ğŸ‘©â€ğŸ³ Instructions:
1. Cut chicken into bite-sized pieces and slice onion thinly
2. Bring dashi, soy sauce, mirin, and sugar to a boil
3. Add chicken and onion, simmer for 5 minutes
...
```

**ğŸ’¡ è¨€èªè‡ªå‹•æ¤œå‡ºã®ä»•çµ„ã¿ï¼š**
1. å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã®è¨€èªã‚’`langdetect`ã§åˆ¤å®š
2. æ—¥æœ¬èªã®å ´åˆï¼šæ—¥æœ¬èªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨
3. è‹±èªã®å ´åˆï¼šè‹±èªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨
4. ãã®ä»–ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è‹±èªå¯¾å¿œ

**ğŸ¯ å®Ÿéš›ã«è©¦ã—ã¦ã¿ã‚ˆã†ï¼š**

ä»¥ä¸‹ã®è³ªå•ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼š

```
æ—¥æœ¬èªï¼š
- "å‘³å™Œæ±ã®ä½œã‚Šæ–¹ã¯ï¼Ÿ"
- "å¤©ã·ã‚‰ã‚’ç¾å‘³ã—ãä½œã‚‹ã‚³ãƒ„ã¯ï¼Ÿ"
- "ãŠå¼å½“ã®ãŠã‹ãšã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æ•™ãˆã¦"

è‹±èªï¼š
- "How to make miso soup?"
- "What's the secret to crispy tempura?"
- "Give me ideas for bento box dishes"
```

**ğŸš¨ ã†ã¾ãå›ç­”ã•ã‚Œãªã„å ´åˆï¼š**
- è³ªå•ãŒæ›–æ˜§ã™ãã‚‹ â†’ ã‚ˆã‚Šå…·ä½“çš„ã«è³ªå•
- çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«ãªã„å†…å®¹ â†’ `knowledge/`ãƒ•ã‚©ãƒ«ãƒ€ã«æƒ…å ±ã‚’è¿½åŠ 
- å›ç­”ãŒé€”ä¸­ã§åˆ‡ã‚Œã‚‹ â†’ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®èª¿æ•´ãŒå¿…è¦

### ğŸ¨ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ã¿ã‚ˆã†

ã€Œå¤ªéƒãã‚“ã€åŸºæœ¬çš„ãªRAGã‚·ã‚¹ãƒ†ãƒ ãŒã§ããŸã‚‰ã€æ¬¡ã¯è‡ªåˆ†ã ã‘ã®ç‰¹åˆ¥ãªã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ã€

AIãŠã°ã‚ã¡ã‚ƒã‚“ã¯ã€å¤ªéƒã«æ›´ãªã‚‹å¯èƒ½æ€§ã‚’è¦‹ã›ã¦ãã‚ŒãŸã€‚

#### ğŸ“š 1. è‡ªåˆ†ã®çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«å¤‰æ›´

**ğŸ¯ ãªãœã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦ï¼Ÿ**
- æ–™ç†ä»¥å¤–ã®åˆ†é‡ï¼ˆå‹‰å¼·ã€ä»•äº‹ã€è¶£å‘³ï¼‰ã§ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
- è‡ªåˆ†å°‚ç”¨ã®æƒ…å ±ã‚’è¿½åŠ ã—ã¦ã€ã‚ˆã‚Šå€‹äººçš„ãªã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ä½œã‚‹
- ä¼šç¤¾ã‚„å­¦æ ¡ã®è³‡æ–™ã‚’æ´»ç”¨ã—ã¦ã€æ¥­å‹™åŠ¹ç‡ã‚’ä¸Šã’ã‚‹

**ğŸ”„ æ‰‹é †1ï¼šæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤**
```bash
# æ—¢å­˜ã®ãƒ¬ã‚·ãƒ”ã‚’å‰Šé™¤
rm knowledge/*.md
```

**ğŸ’¡ ã“ã®ã‚³ãƒãƒ³ãƒ‰ã®èª¬æ˜ï¼š**
- `knowledge/`ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦å‰Šé™¤
- æ–°ã—ã„çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‚’ä½œã‚‹ãŸã‚ã®æº–å‚™
- å®‰å…¨ã®ãŸã‚ã€å‰Šé™¤å‰ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã‚‹ã“ã¨ã‚’æ¨å¥¨

**ğŸ“ æ‰‹é †2ï¼šæ–°ã—ã„çŸ¥è­˜ã‚’è¿½åŠ **
```bash
# è‡ªåˆ†ã®çŸ¥è­˜ã‚’è¿½åŠ 
echo "# My Knowledge Base" > knowledge/my_knowledge.md
```

**ğŸ¨ å®Ÿéš›ã®ä¾‹ï¼š**

**å‹‰å¼·ç”¨ã®ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ**
```markdown
# knowledge/study_notes.md
## æ•°å­¦ã®åŸºç¤
### äºŒæ¬¡æ–¹ç¨‹å¼ã®è§£æ³•
axÂ² + bx + c = 0 ã®å½¢ã®æ–¹ç¨‹å¼ã¯ã€å› æ•°åˆ†è§£ã€å…¬å¼ã€ã‚°ãƒ©ãƒ•ã®æ–¹æ³•ã§è§£ã‘ã¾ã™ã€‚

åˆ¤åˆ¥å¼ D = bÂ² - 4ac ã«ã‚ˆã‚Šã€è§£ã®å€‹æ•°ãŒæ±ºã¾ã‚Šã¾ã™ï¼š
- D > 0ï¼šç•°ãªã‚‹2ã¤ã®å®Ÿæ•°è§£
- D = 0ï¼šé‡è§£ï¼ˆ1ã¤ã®å®Ÿæ•°è§£ï¼‰
- D < 0ï¼š2ã¤ã®è¤‡ç´ æ•°è§£

### ä¸‰è§’é–¢æ•°ã®åŸºæœ¬
sin, cos, tan ã®é–¢ä¿‚ã¨ã€åŠ æ³•å®šç†ã€å€è§’å…¬å¼ã‚’è¦šãˆã¾ã—ã‚‡ã†ã€‚
```

**ä»•äº‹ç”¨ã®ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ**
```markdown
# knowledge/work_knowledge.md
## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
### ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«é–‹ç™ºæ‰‹æ³•
ã‚¹ãƒ—ãƒªãƒ³ãƒˆæœŸé–“ã¯é€šå¸¸2-4é€±é–“ã§è¨­å®šã—ã€æ¯æ—¥ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚

### é¡§å®¢å¯¾å¿œãƒãƒ‹ãƒ¥ã‚¢ãƒ«
ãŠå®¢æ§˜ã‹ã‚‰ã®ãŠå•ã„åˆã‚ã›ã¯24æ™‚é–“ä»¥å†…ã«åˆå›å›ç­”ã‚’è¡Œã„ã€
è§£æ±ºã¾ã§å®šæœŸçš„ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°ã—ã¾ã™ã€‚
```

**è¶£å‘³ç”¨ã®ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ**
```markdown
# knowledge/hobby_knowledge.md
## ã‚®ã‚¿ãƒ¼ã®åŸºç¤
### åŸºæœ¬ã‚³ãƒ¼ãƒ‰
- C: 1ãƒ•ãƒ¬ãƒƒãƒˆ1å¼¦ã€2ãƒ•ãƒ¬ãƒƒãƒˆ4å¼¦ã€3ãƒ•ãƒ¬ãƒƒãƒˆ5å¼¦
- G: 2ãƒ•ãƒ¬ãƒƒãƒˆ5å¼¦ã€3ãƒ•ãƒ¬ãƒƒãƒˆ1å¼¦ã€3ãƒ•ãƒ¬ãƒƒãƒˆ6å¼¦
- Am: 1ãƒ•ãƒ¬ãƒƒãƒˆ2å¼¦ã€2ãƒ•ãƒ¬ãƒƒãƒˆ3å¼¦ã€2ãƒ•ãƒ¬ãƒƒãƒˆ4å¼¦

### ç·´ç¿’æ–¹æ³•
æ¯æ—¥30åˆ†ã®ç·´ç¿’ã‚’ç¶™ç¶šã—ã€åŸºæœ¬ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å§‹ã‚ã¦
å¾ã€…ã«æ¥½æ›²ã«æŒ‘æˆ¦ã—ã¦ã„ãã¾ã™ã€‚
```

#### ğŸ­ 2. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

**ğŸ¯ ãªãœãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼Ÿ**
- AIã®æ€§æ ¼ã‚„å°‚é–€åˆ†é‡ã‚’è¨­å®š
- å›ç­”ã®å£èª¿ã‚„ã‚¹ã‚¿ã‚¤ãƒ«ã‚’èª¿æ•´
- ã‚ˆã‚Šè‡ªç„¶ã§å€‹äººçš„ãªå¯¾è©±ã‚’å®Ÿç¾

**ğŸ“ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†**
```yaml
# prompt/prompt_japanese_cooking.yaml
name: "My AI Assistant"
description: "ã‚ãªãŸã®å°‚é–€åˆ†é‡ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ"
system_prompt: "ã‚ãªãŸã¯[åˆ†é‡]ã®å°‚é–€å®¶ã§ã™ã€‚"
```

**ğŸ¨ å®Ÿéš›ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹ï¼š**

**æ•°å­¦ã®å…ˆç”Ÿã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ**
```yaml
name: "æ•°å­¦ã®å…ˆç”ŸAI"
description: "æ•°å­¦å­¦ç¿’ã‚’æ”¯æ´ã™ã‚‹å„ªã—ã„å…ˆç”Ÿ"
system_prompt: |
  ã‚ãªãŸã¯æ•°å­¦ã®å°‚é–€å®¶ã§ã€å„ªã—ãä¸å¯§ã«æ•™ãˆã‚‹å…ˆç”Ÿã§ã™ã€‚
  ç”Ÿå¾’ãŒåˆ†ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã£ã¦ã‚‚ã€æ®µéšçš„ã«èª¬æ˜ã—ã¦ç†è§£ã‚’ä¿ƒã—ã¾ã™ã€‚
  æ•°å¼ã¯å¯èƒ½ãªé™ã‚Šå…·ä½“ä¾‹ã‚’ç¤ºã—ã€è¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¦ãã ã•ã„ã€‚
  é–“é•ã„ã‚’æŒ‡æ‘˜ã™ã‚‹éš›ã‚‚ã€åŠ±ã¾ã—ãªãŒã‚‰æ­£ã—ã„æ–¹å‘ã«å°ã„ã¦ãã ã•ã„ã€‚
```

**ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ¡ãƒ³ã‚¿ãƒ¼**
```yaml
name: "ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¡ãƒ³ã‚¿ãƒ¼"
description: "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å­¦ç¿’ã‚’æ”¯æ´ã™ã‚‹çµŒé¨“è±Šå¯Œãªãƒ¡ãƒ³ã‚¿ãƒ¼"
system_prompt: |
  ã‚ãªãŸã¯10å¹´ä»¥ä¸Šã®çµŒé¨“ã‚’æŒã¤ã‚·ãƒ‹ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™ã€‚
  ã‚³ãƒ¼ãƒ‰ã®æ›¸ãæ–¹ã€ãƒ‡ãƒãƒƒã‚°æ–¹æ³•ã€ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«ã¤ã„ã¦
  å®Ÿè·µçš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚
  åˆå¿ƒè€…ã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ãã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’äº¤ãˆã¦èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
  ã‚¨ãƒ©ãƒ¼ã®è§£æ±ºæ–¹æ³•ã‚‚å…·ä½“çš„ã«ç¤ºã—ã¦ãã ã•ã„ã€‚
```

**ğŸ”„ å¤‰æ›´ã‚’åæ˜ ã™ã‚‹æ–¹æ³•ï¼š**
```bash
# è¨­å®šå¤‰æ›´å¾Œã¯å¿…ãšã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
# Ctrl+C ã§ã‚µãƒ¼ãƒãƒ¼ã‚’åœæ­¢
# å†åº¦èµ·å‹•
python3 server.py
```

#### ğŸ¨ 3. å¤–è¦³ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

**ğŸ¯ ãªãœUIã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼Ÿ**
- ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã«åˆã‚ã›ãŸå¤–è¦³
- ä½¿ã„ã‚„ã™ã•ã®å‘ä¸Š
- å€‹äººçš„ãªå¥½ã¿ã‚„ãƒ†ãƒ¼ãƒã®åæ˜ 

**ğŸ“ HTMLãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†**
```html
<!-- RAG_demo.html -->
<h1 class="text-3xl font-bold text-white">
    ğŸ¤– My AI Assistant
</h1>
```

**ğŸ¨ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹ï¼š**

**å­¦ç¿’ç”¨ãƒ†ãƒ¼ãƒ**
```html
<h1 class="text-3xl font-bold text-blue-600">
    ğŸ“š Study Buddy AI
</h1>
<!-- èƒŒæ™¯è‰²ã‚’å­¦ç¿’ã«é›†ä¸­ã—ã‚„ã™ã„é’ç³»ã«å¤‰æ›´ -->
<body class="bg-gradient-to-br from-blue-50 to-indigo-100">
```

**ãƒ“ã‚¸ãƒã‚¹ç”¨ãƒ†ãƒ¼ãƒ**
```html
<h1 class="text-3xl font-bold text-gray-800">
    ğŸ’¼ Business Assistant
</h1>
<!-- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªå°è±¡ã®ã‚°ãƒ¬ãƒ¼ç³» -->
<body class="bg-gradient-to-br from-gray-50 to-slate-100">
```

**ğŸ¯ è‰²ã®é¸ã³æ–¹ã®ã‚³ãƒ„ï¼š**
- **æ•™è‚²ç³»**: é’ç³»ï¼ˆé›†ä¸­åŠ›å‘ä¸Šï¼‰
- **ãƒ“ã‚¸ãƒã‚¹ç³»**: ã‚°ãƒ¬ãƒ¼ãƒ»ç´ºç³»ï¼ˆãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ï¼‰
- **å‰µä½œç³»**: ç·‘ç³»ï¼ˆå‰µé€ æ€§ä¿ƒé€²ï¼‰
- **åŒ»ç™‚ç³»**: ç™½ãƒ»æ°´è‰²ç³»ï¼ˆæ¸…æ½”æ„Ÿï¼‰

**ğŸ”„ å¤‰æ›´ã®ç¢ºèªæ–¹æ³•ï¼š**
```bash
# ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°
# Cmd+R (Mac) ã¾ãŸã¯ Ctrl+R (Windows)
# å¤‰æ›´ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèª
```

**ğŸ“± ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®èª¿æ•´ï¼š**
```html
<!-- ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œ -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆå‘ã‘ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ -->
<div class="md:grid-cols-2 lg:grid-cols-3">
    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
</div>
```

**ğŸš€ ã•ã‚‰ãªã‚‹ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š**
- ãƒ­ã‚´ã®è¿½åŠ 
- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã®ä½¿ç”¨
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã®è¿½åŠ 
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- å¤šè¨€èªå¯¾å¿œã®UI

---

## ç¬¬8ç« ï¼šå®Ÿè·µçš„ãªæ´»ç”¨ä¾‹

ã€Œå¤ªéƒãã‚“ã€RAGã‚·ã‚¹ãƒ†ãƒ ã¯æ–™ç†ã ã‘ã˜ã‚ƒãªãã¦ã€ã„ã‚ã‚“ãªåˆ†é‡ã§æ´»ç”¨ã§ãã‚‹ã®ã‚ˆã€

AIãŠã°ã‚ã¡ã‚ƒã‚“ã¯ã€å¤ªéƒã«æ§˜ã€…ãªæ´»ç”¨ä¾‹ã‚’è¦‹ã›ã¦ãã‚ŒãŸã€‚

### ğŸ’¼ ãƒ“ã‚¸ãƒã‚¹ã§ã®æ´»ç”¨

#### ğŸ¢ 1. ç¤¾å†…FAQ ã‚·ã‚¹ãƒ†ãƒ 

**ğŸ¯ ãªãœç¤¾å†…FAQãŒå¿…è¦ï¼Ÿ**
- å¾“æ¥­å“¡ã®è³ªå•å¯¾å¿œæ™‚é–“ã‚’90%çŸ­ç¸®
- äººäº‹éƒ¨é–€ã¸ã®å•ã„åˆã‚ã›ä»¶æ•°ã‚’å¤§å¹…å‰Šæ¸›
- æ–°å…¥ç¤¾å“¡ã®è‡ªç«‹ã‚’ä¿ƒé€²
- 24æ™‚é–“365æ—¥ã„ã¤ã§ã‚‚å›ç­”å¯èƒ½

**ğŸ“ å®Ÿè£…æ‰‹é †ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šFAQãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ**
```markdown
# knowledge/company_faq.md
## æœ‰çµ¦ä¼‘æš‡ã®å–å¾—æ–¹æ³•
### ç”³è«‹æ‰‹é †
1. ç¤¾å†…ã‚·ã‚¹ãƒ†ãƒ ã«ãƒ­ã‚°ã‚¤ãƒ³
2. ä¼‘æš‡ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ ã‚’å…¥åŠ›
3. ä¸Šå¸ã«æ‰¿èªä¾é ¼
4. æ‰¿èªå¾Œã€äººäº‹ã«è‡ªå‹•é€šçŸ¥

### æœ‰çµ¦æ—¥æ•°ã®ç¢ºèª
- 1å¹´ç›®ï¼š10æ—¥é–“
- 2å¹´ç›®ï¼š11æ—¥é–“
- 3å¹´ç›®ä»¥é™ï¼šå¹´é–“20æ—¥é–“ã¾ã§

### ç·Šæ€¥æ™‚ã®å¯¾å¿œ
æ€¥ç—…ã®å ´åˆã¯ã€äº‹å¾Œç”³è«‹ã‚‚å¯èƒ½ã§ã™ã€‚
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æœ€é©åŒ–**
```yaml
# prompt/prompt_japanese_cooking.yaml
name: "ç¤¾å†…FAQã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ"
description: "ç¤¾å†…è¦å‰‡ã‚„æ‰‹ç¶šãã«é–¢ã™ã‚‹è³ªå•ã«ãŠç­”ãˆã—ã¾ã™"
system_prompt: |
  ã‚ãªãŸã¯ä¼šç¤¾ã®äººäº‹éƒ¨é–€ã®å°‚é–€ã‚¹ã‚¿ãƒƒãƒ•ã§ã™ã€‚
  å¾“æ¥­å“¡ã‹ã‚‰ã®è³ªå•ã«å¯¾ã—ã¦ã€æ­£ç¢ºã§åˆ†ã‹ã‚Šã‚„ã™ã„å›ç­”ã‚’æä¾›ã—ã¾ã™ã€‚
  ä¸æ˜ãªç‚¹ãŒã‚ã‚‹å ´åˆã¯ã€äººäº‹éƒ¨é–€ã¸ã®ç¢ºèªã‚’ä¿ƒã—ã¦ãã ã•ã„ã€‚
  å¸¸ã«è¦ªåˆ‡ã§ä¸å¯§ãªå¯¾å¿œã‚’å¿ƒãŒã‘ã¦ãã ã•ã„ã€‚
```

**ğŸ¯ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœï¼š**
- äººäº‹éƒ¨é–€ã®å•ã„åˆã‚ã›ä»¶æ•°ï¼šæœˆ100ä»¶ â†’ æœˆ15ä»¶
- å›ç­”æ™‚é–“ï¼šå¹³å‡2æ™‚é–“ â†’ å³åº§ã«å›ç­”
- å¾“æ¥­å“¡æº€è¶³åº¦ï¼š85% â†’ 95%ã«å‘ä¸Š

#### ğŸ“– 2. è£½å“ãƒãƒ‹ãƒ¥ã‚¢ãƒ«

**ğŸ¯ ãªãœã‚¹ãƒãƒ¼ãƒˆãªãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãŒå¿…è¦ï¼Ÿ**
- é¡§å®¢ã‚µãƒãƒ¼ãƒˆã‚³ã‚¹ãƒˆã‚’70%å‰Šæ¸›
- è£½å“ã®ä½¿ã„æ–¹ã‚’å³åº§ã«æ¤œç´¢å¯èƒ½
- å¤šè¨€èªå¯¾å¿œã§æµ·å¤–å±•é–‹ã‚’ã‚µãƒãƒ¼ãƒˆ
- å‹•ç”»ã‚„ç”»åƒã‚‚å«ã‚ãŸåŒ…æ‹¬çš„ãªèª¬æ˜

**ğŸ“ å®Ÿè£…æ‰‹é †ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æ•´ç†**
```markdown
# knowledge/product_manual.md
## è£½å“Aã®ä½¿ç”¨æ–¹æ³•
### åˆæœŸè¨­å®š
1. é›»æºã‚’å…¥ã‚Œã‚‹
2. è¨­å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
3. Wi-Fiè¨­å®šã‚’å®Œäº†
4. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•
**Q: é›»æºãŒå…¥ã‚‰ãªã„**
A: ä»¥ä¸‹ã®æ‰‹é †ã§ç¢ºèªã—ã¦ãã ã•ã„ï¼š
1. é›»æºã‚±ãƒ¼ãƒ–ãƒ«ãŒæ­£ã—ãæ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã‹
2. ã‚³ãƒ³ã‚»ãƒ³ãƒˆã«é›»æºãŒä¾›çµ¦ã•ã‚Œã¦ã„ã‚‹ã‹
3. æœ¬ä½“ã®é›»æºãƒœã‚¿ãƒ³ã‚’3ç§’é–“é•·æŠ¼ã—

**Q: Wi-Fiæ¥ç¶šãŒã§ããªã„**
A: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
1. Wi-Fiãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ã„ã‹
2. 2.4GHzå¸¯åŸŸã«æ¥ç¶šã—ã¦ã„ã‚‹ã‹
3. ãƒ«ãƒ¼ã‚¿ãƒ¼ã®å†èµ·å‹•ã‚’è©¦ã™
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šæ¤œç´¢ã®æœ€é©åŒ–**
```bash
# ã‚ˆã‚Šè©³ç´°ãªæ¤œç´¢çµæœã‚’å–å¾—
# config.py ã®è¨­å®šã‚’èª¿æ•´
RETRIEVAL_K = 5  # æ¤œç´¢çµæœæ•°ã‚’å¢—åŠ 
CHUNK_SIZE = 800  # ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã‚’èª¿æ•´
```

**ğŸ¯ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœï¼š**
- ã‚µãƒãƒ¼ãƒˆå•ã„åˆã‚ã›ï¼šæœˆ500ä»¶ â†’ æœˆ150ä»¶
- é¡§å®¢æº€è¶³åº¦ï¼š78% â†’ 92%
- ã‚µãƒãƒ¼ãƒˆæ‹…å½“è€…ã®å·¥æ•°ï¼š60%å‰Šæ¸›

### ğŸ“ æ•™è‚²ã§ã®æ´»ç”¨

#### ğŸ“š 1. å­¦ç¿’æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ 

**ğŸ¯ ãªãœå­¦ç¿’æ”¯æ´AIãŒæœ‰åŠ¹ï¼Ÿ**
- å€‹äººã®ãƒšãƒ¼ã‚¹ã«åˆã‚ã›ãŸå­¦ç¿’ãŒå¯èƒ½
- 24æ™‚é–“ã„ã¤ã§ã‚‚è³ªå•ã§ãã‚‹
- ç¹°ã‚Šè¿”ã—å­¦ç¿’ã§ç†è§£åº¦ã‚’å‘ä¸Š
- è‹¦æ‰‹åˆ†é‡ã®é›†ä¸­çš„ãªå­¦ç¿’ã‚’ã‚µãƒãƒ¼ãƒˆ

**ğŸ“ å®Ÿè£…æ‰‹é †ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šå­¦ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æº–å‚™**
```markdown
# knowledge/math_basics.md
## äºŒæ¬¡æ–¹ç¨‹å¼ã®è§£æ³•
### å› æ•°åˆ†è§£ã«ã‚ˆã‚‹è§£æ³•
axÂ² + bx + c = 0 ã®å½¢ã®æ–¹ç¨‹å¼ã¯å› æ•°åˆ†è§£ã§è§£ã‘ã¾ã™ã€‚

**ä¾‹é¡Œ1ï¼š** xÂ² + 5x + 6 = 0
è§£æ³•ï¼š
1. å› æ•°åˆ†è§£ï¼š(x + 2)(x + 3) = 0
2. å„å› æ•°ã‚’ã‚¼ãƒ­ã¨ã™ã‚‹ï¼šx + 2 = 0 ã¾ãŸã¯ x + 3 = 0
3. è§£ï¼šx = -2, -3

**ç·´ç¿’å•é¡Œï¼š**
- xÂ² + 7x + 12 = 0
- xÂ² - 5x + 6 = 0
- xÂ² + 3x - 4 = 0
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šæ•™å¸«ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```yaml
name: "æ•°å­¦ã®å…ˆç”ŸAI"
description: "æ•°å­¦å­¦ç¿’ã‚’æ”¯æ´ã™ã‚‹å„ªã—ã„å…ˆç”Ÿ"
system_prompt: |
  ã‚ãªãŸã¯çµŒé¨“è±Šå¯Œãªæ•°å­¦æ•™å¸«ã§ã™ã€‚
  ç”Ÿå¾’ã®ç†è§£åº¦ã«å¿œã˜ã¦ã€æ®µéšçš„ã«èª¬æ˜ã—ã¾ã™ã€‚
  é–“é•ã„ãŒã‚ã£ã¦ã‚‚åŠ±ã¾ã—ãªãŒã‚‰ã€æ­£ã—ã„æ–¹å‘ã«å°ã„ã¦ãã ã•ã„ã€‚
  å…·ä½“ä¾‹ã‚’å¤šãä½¿ã„ã€è¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¦ãã ã•ã„ã€‚
  å¿…è¦ã«å¿œã˜ã¦ã€è¿½åŠ ã®ç·´ç¿’å•é¡Œã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
```

**ğŸ¯ å­¦ç¿’åŠ¹æœã®æ¸¬å®šï¼š**
- ç†è§£åº¦ãƒ†ã‚¹ãƒˆã®å¹³å‡ç‚¹ï¼š65ç‚¹ â†’ 82ç‚¹
- å­¦ç¿’ç¶™ç¶šç‡ï¼š40% â†’ 75%
- è³ªå•å›æ•°ï¼šé€±1å› â†’ é€±5å›ï¼ˆç©æ¥µçš„ãªå­¦ç¿’ï¼‰

#### ğŸŒ 2. è¨€èªå­¦ç¿’ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ

**ğŸ¯ ãªãœè¨€èªå­¦ç¿’ã«RAGãŒåŠ¹æœçš„ï¼Ÿ**
- æ–‡è„ˆã«å¿œã˜ãŸé©åˆ‡ãªè¡¨ç¾ã‚’ææ¡ˆ
- ä¼šè©±ç·´ç¿’ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã—ã¦æ©Ÿèƒ½
- æ–‡æ³•èª¬æ˜ã‚’å®Ÿç”¨çš„ãªä¾‹æ–‡ã§æä¾›
- å­¦ç¿’è€…ã®ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸæ®µéšçš„ãªæŒ‡å°

**ğŸ“ å®Ÿè£…æ‰‹é †ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šè¨€èªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰**
```markdown
# knowledge/english_phrases.md
## æ—¥å¸¸ä¼šè©±ãƒ•ãƒ¬ãƒ¼ã‚º
### æŒ¨æ‹¶
- Good morning = ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™
- How are you? = èª¿å­ã¯ã©ã†ï¼Ÿ
- Nice to meet you = ã¯ã˜ã‚ã¾ã—ã¦

### å ´é¢åˆ¥è¡¨ç¾
**ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§ï¼š**
- I'd like to make a reservation = äºˆç´„ã‚’å–ã‚ŠãŸã„ã®ã§ã™ãŒ
- Can I have the menu? = ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ
- The check, please = ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™

**è²·ã„ç‰©ã§ï¼š**
- How much is this? = ã“ã‚Œã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ
- Do you have this in a different size? = é•ã†ã‚µã‚¤ã‚ºã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ
- I'm just looking = è¦‹ã¦ã„ã‚‹ã ã‘ã§ã™
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šè¨€èªå­¦ç¿’ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```yaml
name: "è‹±ä¼šè©±ã‚³ãƒ¼ãƒ"
description: "è‹±èªå­¦ç¿’ã‚’æ”¯æ´ã™ã‚‹è¦ªåˆ‡ãªã‚³ãƒ¼ãƒ"
system_prompt: |
  ã‚ãªãŸã¯è‹±èªå­¦ç¿’ã®å°‚é–€ã‚³ãƒ¼ãƒã§ã™ã€‚
  å­¦ç¿’è€…ã®ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦ã€é©åˆ‡ãªè¡¨ç¾ã‚’ææ¡ˆã—ã¾ã™ã€‚
  ç™ºéŸ³ã®ã‚³ãƒ„ã€æ–‡æ³•ã®èª¬æ˜ã€å®Ÿè·µçš„ãªä½¿ã„æ–¹ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
  é–“é•ã„ã‚’å„ªã—ãè¨‚æ­£ã—ã€è‡ªä¿¡ã‚’æŒã£ã¦è©±ã›ã‚‹ã‚ˆã†åŠ±ã¾ã—ã¦ãã ã•ã„ã€‚
  æ–‡åŒ–çš„ãªèƒŒæ™¯ã‚‚å«ã‚ã¦ã€è‡ªç„¶ãªè‹±èªè¡¨ç¾ã‚’æŒ‡å°ã—ã¦ãã ã•ã„ã€‚
```

**ğŸ¯ å­¦ç¿’åŠ¹æœï¼š**
- èªå½™åŠ›ï¼š500èª â†’ 1,500èªï¼ˆ3ãƒ¶æœˆï¼‰
- ä¼šè©±ç¶™ç¶šæ™‚é–“ï¼š30ç§’ â†’ 5åˆ†
- å­¦ç¿’ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼šå¤§å¹…å‘ä¸Š

### ğŸ  å€‹äººã§ã®æ´»ç”¨

#### ğŸ’° 1. å®¶è¨ˆç°¿ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ

**ğŸ¯ ãªãœå®¶è¨ˆç®¡ç†ã«RAGãŒå½¹ç«‹ã¤ï¼Ÿ**
- æ”¯å‡ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æã¨æ”¹å–„ææ¡ˆ
- ç¯€ç´„ã‚¢ã‚¤ãƒ‡ã‚¢ã®å€‹äººåŒ–
- äºˆç®—ç®¡ç†ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒ‰ãƒã‚¤ã‚¹
- æŠ•è³‡ã‚„è²¯è“„ã®æˆ¦ç•¥ææ¡ˆ

**ğŸ“ å®Ÿè£…æ‰‹é †ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šå®¶è¨ˆæƒ…å ±ã®æ•´ç†**
```markdown
# knowledge/finance_tips.md
## å®¶è¨ˆç®¡ç†ã®ã‚³ãƒ„
### æ”¯å‡ºã®è¨˜éŒ²æ–¹æ³•
1. ãƒ¬ã‚·ãƒ¼ãƒˆã‚’å†™çœŸã§ä¿å­˜
2. ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«åˆ†é¡ï¼ˆé£Ÿè²»ã€äº¤é€šè²»ã€å¨¯æ¥½è²»ãªã©ï¼‰
3. æœˆæœ«ã«é›†è¨ˆã—ã¦äºˆç®—ã¨æ¯”è¼ƒ
4. ç„¡é§„é£ã„ã‚’ç‰¹å®šã—ã¦æ”¹å–„

### ç¯€ç´„ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯
**é£Ÿè²»ã®å‰Šæ¸›ï¼š**
- é€±å˜ä½ã§ã®è²·ã„ç‰©è¨ˆç”»
- ç‰¹å£²æ—¥ã®æ´»ç”¨
- å†·å‡é£Ÿå“ã®æ´»ç”¨
- è‡ªç‚Šã®ç¿’æ…£åŒ–

**å›ºå®šè²»ã®è¦‹ç›´ã—ï¼š**
- æºå¸¯æ–™é‡‘ãƒ—ãƒ©ãƒ³ã®æœ€é©åŒ–
- ä¿é™ºã®è¦‹ç›´ã—
- å®šæœŸè³¼èª­ã‚µãƒ¼ãƒ“ã‚¹ã®æ•´ç†
```

**ğŸ¯ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœï¼š**
- æœˆé–“æ”¯å‡ºï¼š15%å‰Šæ¸›
- è²¯è“„é¡ï¼šæœˆ3ä¸‡å†† â†’ æœˆ5ä¸‡å††
- å®¶è¨ˆç®¡ç†æ™‚é–“ï¼šé€±2æ™‚é–“ â†’ é€±30åˆ†

#### ğŸƒâ€â™‚ï¸ 2. å¥åº·ç®¡ç†ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ

**ğŸ¯ ãªãœå¥åº·ç®¡ç†ã«RAGãŒåŠ¹æœçš„ï¼Ÿ**
- å€‹äººã®ä½“è³ªã‚„ç”Ÿæ´»ç¿’æ…£ã«åˆã‚ã›ãŸã‚¢ãƒ‰ãƒã‚¤ã‚¹
- é‹å‹•ã‚„é£Ÿäº‹ã®ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ãªææ¡ˆ
- å¥åº·çŠ¶æ…‹ã®ç¶™ç¶šçš„ãªãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ç¶­æŒã®ã‚µãƒãƒ¼ãƒˆ

**ğŸ“ å®Ÿè£…æ‰‹é †ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šå¥åº·æƒ…å ±ã®è“„ç©**
```markdown
# knowledge/health_tips.md
## é‹å‹•ç¿’æ…£ã®ä½œã‚Šæ–¹
### åˆå¿ƒè€…å‘ã‘ãƒ¡ãƒ‹ãƒ¥ãƒ¼
- é€±3å›ã€30åˆ†ã®ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°
- æ¯æ—¥5åˆ†ã®ã‚¹ãƒˆãƒ¬ãƒƒãƒ
- éšæ®µã‚’ä½¿ã†ç¿’æ…£
- å®¶äº‹ã‚’é‹å‹•ã¨ã—ã¦æ´»ç”¨

### é£Ÿäº‹ç®¡ç†
**ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„é£Ÿäº‹ï¼š**
- é‡èœï¼š1æ—¥350gä»¥ä¸Š
- ã‚¿ãƒ³ãƒ‘ã‚¯è³ªï¼šä½“é‡Ã—1.2g
- ç‚­æ°´åŒ–ç‰©ï¼šå…¨ã‚«ãƒ­ãƒªãƒ¼ã®50-60%
- è„‚è³ªï¼šå…¨ã‚«ãƒ­ãƒªãƒ¼ã®20-25%

### ç¡çœ ã®è³ªå‘ä¸Š
- å°±å¯2æ™‚é–“å‰ã®ã‚¹ãƒãƒ›ä½¿ç”¨åœæ­¢
- å®¤æ¸©18-22åº¦ã®ç¶­æŒ
- è¦å‰‡æ­£ã—ã„å°±å¯æ™‚é–“
- ã‚«ãƒ•ã‚§ã‚¤ãƒ³ã¯åˆå¾Œ2æ™‚ä»¥é™æ§ãˆã‚‹
```

**ğŸ¯ å¥åº·æ”¹å–„åŠ¹æœï¼š**
- ä½“é‡ï¼š3ãƒ¶æœˆã§5kgæ¸›é‡
- ç¡çœ ã®è³ªï¼š40%æ”¹å–„
- é‹å‹•ç¶™ç¶šç‡ï¼š30% â†’ 80%
- å¥åº·è¨ºæ–­çµæœï¼šã™ã¹ã¦æ­£å¸¸ç¯„å›²å†…

---

## ç¬¬9ç« ï¼šã•ã‚‰ãªã‚‹ç™ºå±•ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

ã€Œå¤ªéƒãã‚“ã€åŸºæœ¬çš„ãªRAGã‚·ã‚¹ãƒ†ãƒ ãŒã§ããŸã‚‰ã€æ¬¡ã¯æœ¬æ ¼çš„ãªé‹ç”¨ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€

AIãŠã°ã‚ã¡ã‚ƒã‚“ã¯ã€å¤ªéƒã«ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªRAGã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰æ–¹æ³•ã‚’æ•™ãˆã¦ãã‚ŒãŸã€‚

### ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### âš¡ 1. ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã®æœ€é©åŒ–

**ğŸ¯ ãªãœãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºãŒé‡è¦ï¼Ÿ**
- æ¤œç´¢ç²¾åº¦ã¨å›ç­”å“è³ªã«ç›´æ¥å½±éŸ¿
- è¨ˆç®—ã‚³ã‚¹ãƒˆã¨ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’å·¦å³
- æ–‡è„ˆã®ä¿æŒã¨å‡¦ç†é€Ÿåº¦ã®ãƒãƒ©ãƒ³ã‚¹

**ğŸ“ æœ€é©åŒ–æ‰‹é †ï¼š**

```python
# config.py
CHUNK_SIZE = 1000  # é•·ã„æ–‡æ›¸ã®å ´åˆ
CHUNK_OVERLAP = 200  # é‡è¤‡ã‚’å¢—ã‚„ã—ã¦æ–‡è„ˆã‚’ä¿æŒ
```

**ğŸ’¡ ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã®é¸ã³æ–¹ï¼š**

| æ–‡æ›¸ã‚¿ã‚¤ãƒ— | æ¨å¥¨ã‚µã‚¤ã‚º | é‡è¤‡ | ç†ç”± |
|------------|------------|------|------|
| çŸ­ã„è¨˜äº‹   | 500-800    | 100  | è¦ç‚¹ã‚’1ã¤ã®ãƒãƒ£ãƒ³ã‚¯ã« |
| æŠ€è¡“æ–‡æ›¸   | 1000-1500  | 200  | è¤‡é›‘ãªæ¦‚å¿µã‚’ä¿æŒ |
| å°èª¬ãƒ»ç‰©èª | 800-1200   | 150  | æ–‡è„ˆã¨æµã‚Œã‚’ç¶­æŒ |
| FAQ        | 300-500    | 50   | 1å•1ç­”ã‚’1ãƒãƒ£ãƒ³ã‚¯ã« |

**ğŸ”§ å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆæ–¹æ³•ï¼š**
```python
# ç•°ãªã‚‹ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã§ãƒ†ã‚¹ãƒˆ
chunk_sizes = [500, 1000, 1500]
for size in chunk_sizes:
    # è¨­å®šå¤‰æ›´
    CHUNK_SIZE = size
    # ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢å†æ§‹ç¯‰
    python3 run_etl.py
    # è³ªå•ãƒ†ã‚¹ãƒˆ
    test_query = "è¦ªå­ä¸¼ã®ä½œã‚Šæ–¹"
    # å›ç­”å“è³ªã‚’è©•ä¾¡
```

#### ğŸ” 2. æ¤œç´¢çµæœæ•°ã®æœ€é©åŒ–

**ğŸ¯ ãªãœæ¤œç´¢çµæœæ•°ãŒé‡è¦ï¼Ÿ**
- æƒ…å ±ã®ç¶²ç¾…æ€§ã¨å‡¦ç†é€Ÿåº¦ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•
- é–¢é€£æ€§ã®ä½ã„æƒ…å ±ã®æ··å…¥ã‚’é˜²ã
- APIã‚³ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã«å½±éŸ¿

```python
RETRIEVAL_K = 10  # ã‚ˆã‚Šå¤šãã®é–¢é€£æƒ…å ±ã‚’å–å¾—
```

**ğŸ“Š æ¤œç´¢çµæœæ•°ã®åŠ¹æœåˆ†æï¼š**

| æ¤œç´¢çµæœæ•° | å›ç­”å“è³ª | å‡¦ç†æ™‚é–“ | APIã‚³ã‚¹ãƒˆ | æ¨å¥¨ç”¨é€” |
|------------|----------|----------|-----------|----------|
| 3-5        | æ™®é€š     | é«˜é€Ÿ     | ä½        | ç°¡å˜ãªè³ªå• |
| 8-10       | è‰¯å¥½     | ä¸­ç¨‹åº¦   | ä¸­        | ä¸€èˆ¬çš„ãªè³ªå• |
| 15-20      | å„ªç§€     | ä½é€Ÿ     | é«˜        | è¤‡é›‘ãªè³ªå• |

**ğŸ¯ å‹•çš„èª¿æ•´ã®å®Ÿè£…ï¼š**
```python
def get_dynamic_k(query: str) -> int:
    # è³ªå•ã®è¤‡é›‘ã•ã«å¿œã˜ã¦æ¤œç´¢çµæœæ•°ã‚’èª¿æ•´
    if len(query.split()) <= 5:
        return 5  # ç°¡å˜ãªè³ªå•
    elif len(query.split()) <= 10:
        return 8  # ä¸­ç¨‹åº¦ã®è³ªå•
    else:
        return 12  # è¤‡é›‘ãªè³ªå•
```

#### ğŸ¤– 3. ãƒ¢ãƒ‡ãƒ«ã®é¸æŠã¨æœ€é©åŒ–

**ğŸ¯ ãƒ¢ãƒ‡ãƒ«é¸æŠã®åŸºæº–ï¼š**

```python
LLM_MODEL = "gpt-3.5-turbo"  # ã‚³ã‚¹ãƒˆé‡è¦–
LLM_MODEL = "gpt-4o"         # å“è³ªé‡è¦–
```

**ğŸ“Š ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒè¡¨ï¼š**

| ãƒ¢ãƒ‡ãƒ« | å“è³ª | é€Ÿåº¦ | ã‚³ã‚¹ãƒˆ | æ¨å¥¨ç”¨é€” |
|--------|------|------|--------|----------|
| GPT-3.5-turbo | è‰¯å¥½ | é«˜é€Ÿ | ä½ | ä¸€èˆ¬çš„ãªè³ªå•å¿œç­” |
| GPT-4o | å„ªç§€ | ä¸­é€Ÿ | ä¸­ | è¤‡é›‘ãªåˆ†æãƒ»æ¨è«– |
| GPT-4-turbo | æœ€é«˜ | ä½é€Ÿ | é«˜ | å°‚é–€çš„ãªè³ªå• |

**âš™ï¸ ç”¨é€”åˆ¥è¨­å®šä¾‹ï¼š**

```python
# æœ¬ç•ªç’°å¢ƒç”¨ï¼ˆå“è³ªé‡è¦–ï¼‰
PRODUCTION_CONFIG = {
    "model": "gpt-4o",
    "temperature": 0.1,
    "max_tokens": 1000,
    "top_p": 0.9
}

# é–‹ç™ºç’°å¢ƒç”¨ï¼ˆã‚³ã‚¹ãƒˆé‡è¦–ï¼‰
DEVELOPMENT_CONFIG = {
    "model": "gpt-3.5-turbo",
    "temperature": 0.3,
    "max_tokens": 500,
    "top_p": 0.8
}
```

### ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

#### ğŸ›¡ï¸ 1. ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†

**ğŸ¯ ãªãœã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒé‡è¦ï¼Ÿ**
- APIã‚­ãƒ¼ã®æ¼æ´©é˜²æ­¢
- æ©Ÿå¯†æƒ…å ±ã®ä¿è­·
- ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã®é˜²æ­¢

```bash
# .env ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¿…ãš .gitignore ã«è¿½åŠ 
echo ".env" >> .gitignore
```

**ğŸ” å®Œå…¨ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šï¼š**

```bash
# .env.exampleï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰
OPENAI_API_KEY=your-api-key-here
DEMO_USERNAME=admin
DEMO_PASSWORD=your-secure-password
JWT_SECRET=your-jwt-secret-key
ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com
```

```bash
# .gitignore
.env
.env.local
.env.production
*.log
vector_store/
__pycache__/
```

**ğŸš¨ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼š**
- [ ] APIã‚­ãƒ¼ãŒ.envãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹
- [ ] .envãƒ•ã‚¡ã‚¤ãƒ«ãŒ.gitignoreã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] æœ¬ç•ªç’°å¢ƒã§ã¯å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨
- [ ] HTTPSé€šä¿¡ã‚’ä½¿ç”¨
- [ ] å®šæœŸçš„ãªAPIã‚­ãƒ¼ã®ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

#### ğŸ” 2. å…¥åŠ›æ¤œè¨¼

**ğŸ¯ ãªãœå…¥åŠ›æ¤œè¨¼ãŒå¿…è¦ï¼Ÿ**
- ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã®é˜²æ­¢
- ç•°å¸¸ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ¤œå‡º
- ã‚·ã‚¹ãƒ†ãƒ ã®å®‰å®šæ€§ç¢ºä¿

```python
class QueryRequest(BaseModel):
    query: str = Field(..., max_length=1000)
    user_id: str = Field(..., max_length=100)
```

**ğŸ›¡ï¸ åŒ…æ‹¬çš„ãªå…¥åŠ›æ¤œè¨¼ï¼š**

```python
from pydantic import BaseModel, Field, validator
import re

class QueryRequest(BaseModel):
    query: str = Field(..., min_length=1, max_length=1000)
    user_id: str = Field(..., max_length=100)
    language: str = Field(default="auto", regex="^(auto|ja|en)$")
    
    @validator('query')
    def validate_query(cls, v):
        # å±é™ºãªæ–‡å­—ã®é™¤å¤–
        dangerous_chars = ['<', '>', '"', "'", '&']
        for char in dangerous_chars:
            if char in v:
                raise ValueError(f'å±é™ºãªæ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™: {char}')
        return v
    
    @validator('user_id')
    def validate_user_id(cls, v):
        # è‹±æ•°å­—ã¨ãƒã‚¤ãƒ•ãƒ³ã®ã¿è¨±å¯
        if not re.match(r'^[a-zA-Z0-9-]+$', v):
            raise ValueError('ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¯è‹±æ•°å­—ã¨ãƒã‚¤ãƒ•ãƒ³ã®ã¿ä½¿ç”¨å¯èƒ½ã§ã™')
        return v
```

#### â±ï¸ 3. ãƒ¬ãƒ¼ãƒˆåˆ¶é™

**ğŸ¯ ãªãœãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒå¿…è¦ï¼Ÿ**
- DDoSæ”»æ’ƒã®é˜²æ­¢
- APIã‚³ã‚¹ãƒˆã®åˆ¶å¾¡
- ã‚µãƒ¼ãƒãƒ¼ãƒªã‚½ãƒ¼ã‚¹ã®ä¿è­·

```python
from slowapi import Limiter
limiter = Limiter(key_func=get_remote_address)

@app.post("/query")
@limiter.limit("10/minute")
async def query_endpoint(request: Request, ...):
    pass
```

**âš™ï¸ æ®µéšçš„ãªãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼š**

```python
# slowapi ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install slowapi

# server.py
from slowapi import Limiter, _rate_limit_exceeded_handler
from slowapi.util import get_remote_address
from slowapi.errors import RateLimitExceeded

limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter
app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)

# æ®µéšçš„ãªåˆ¶é™
@app.post("/query")
@limiter.limit("5/minute")    # 1åˆ†é–“ã«5å›
@limiter.limit("50/hour")     # 1æ™‚é–“ã«50å›
@limiter.limit("500/day")     # 1æ—¥ã«500å›
async def query_endpoint(request: Request, query_data: QueryRequest):
    # å‡¦ç†...
```

**ğŸ“Š ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­å®šã®ä¾‹ï¼š**

| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ— | 1åˆ†é–“ | 1æ™‚é–“ | 1æ—¥é–“ | ç”¨é€” |
|----------------|--------|--------|--------|------|
| åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼   | 3å›    | 20å›   | 100å›  | è©¦ç”¨ |
| ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼   | 10å›   | 100å›  | 1000å› | ä¸€èˆ¬åˆ©ç”¨ |
| ãƒ—ãƒ¬ãƒŸã‚¢ãƒ      | 30å›   | 500å›  | 5000å› | é«˜é »åº¦åˆ©ç”¨ |
| é–‹ç™ºè€…         | 100å›  | 2000å› | 10000å›| APIé–‹ç™º |

**ğŸ”§ ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼š**

```python
def get_user_limit(user_id: str) -> str:
    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸåˆ¶é™
    user_type = get_user_type(user_id)
    
    if user_type == "premium":
        return "30/minute"
    elif user_type == "registered":
        return "10/minute"
    else:
        return "3/minute"

@app.post("/query")
async def query_endpoint(request: Request, query_data: QueryRequest):
    limit = get_user_limit(query_data.user_id)
    await limiter.limit(limit)(request)
    # å‡¦ç†...
```

### ğŸ“Š ç›£è¦–ã¨ãƒ­ã‚°

**1. æ§‹é€ åŒ–ãƒ­ã‚°**
```python
import logging
import json

logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

logger = logging.getLogger(__name__)

def log_query(query: str, response: str, user_id: str):
    logger.info(json.dumps({
        "event": "query_processed",
        "query": query,
        "response_length": len(response),
        "user_id": user_id,
        "timestamp": datetime.now().isoformat()
    }))
```

**2. ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†**
```python
from prometheus_client import Counter, Histogram

query_counter = Counter('rag_queries_total', 'Total queries processed')
response_time = Histogram('rag_response_time_seconds', 'Response time')

@response_time.time()
def process_query(query: str):
    query_counter.inc()
    # å‡¦ç†...
```

---

## ç¬¬10ç« ï¼šãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ã€Œå¤ªéƒãã‚“ã€ã©ã‚“ãªã‚·ã‚¹ãƒ†ãƒ ã§ã‚‚å•é¡Œã¯ç™ºç”Ÿã™ã‚‹ã‚‚ã®ã€‚å¤§åˆ‡ãªã®ã¯ã€å•é¡Œã‚’ç´ æ—©ãè¦‹ã¤ã‘ã¦è§£æ±ºã™ã‚‹ã“ã¨ã‚ˆã€

AIãŠã°ã‚ã¡ã‚ƒã‚“ã¯ã€å¤ªéƒã«å®Ÿè·µçš„ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®æ–¹æ³•ã‚’æ•™ãˆã¦ãã‚ŒãŸã€‚

### ğŸ› ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•

#### ğŸ” 1. ModuleNotFoundError

**ğŸš¨ ã‚¨ãƒ©ãƒ¼ä¾‹ï¼š**
```bash
ModuleNotFoundError: No module named 'langchain'
ModuleNotFoundError: No module named 'langdetect'
```

**ğŸ’¡ åŸå› ï¼š**
- ä»®æƒ³ç’°å¢ƒãŒæ­£ã—ãæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ãªã„
- å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„
- Pythonã®ãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹

**ğŸ”§ è§£æ±ºæ³•ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šç’°å¢ƒã®ç¢ºèª**
```bash
# ä»®æƒ³ç’°å¢ƒã®ç¢ºèª
which python
# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼š/path/to/venv/bin/python

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç¢ºèª
pip list | grep langchain
pip list | grep langdetect
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šä»®æƒ³ç’°å¢ƒã®å†æœ‰åŠ¹åŒ–**
```bash
# ä»®æƒ³ç’°å¢ƒã‚’ç„¡åŠ¹åŒ–
deactivate

# å†åº¦æœ‰åŠ¹åŒ–
source venv/bin/activate  # Linux/Mac
# ã¾ãŸã¯
venv\Scripts\activate     # Windows

# ç¢ºèª
echo $VIRTUAL_ENV
```

**ã‚¹ãƒ†ãƒƒãƒ—3ï¼šãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
```bash
# å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# å€‹åˆ¥ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install langchain langdetect fastapi uvicorn
```

**ğŸš¨ äºˆé˜²ç­–ï¼š**
- ä½œæ¥­é–‹å§‹æ™‚ã«å¿…ãšä»®æƒ³ç’°å¢ƒã‚’ç¢ºèª
- requirements.txtã‚’å¸¸ã«æœ€æ–°ã«ä¿ã¤
- å®šæœŸçš„ãªä¾å­˜é–¢ä¿‚ã®ãƒã‚§ãƒƒã‚¯

#### ğŸ”‘ 2. OpenAI API ã‚¨ãƒ©ãƒ¼

**ğŸš¨ ã‚¨ãƒ©ãƒ¼ä¾‹ï¼š**
```bash
openai.error.RateLimitError: Rate limit exceeded
openai.error.InvalidRequestError: Invalid API key
openai.error.AuthenticationError: Incorrect API key
```

**ğŸ’¡ åŸå› ï¼š**
- APIã‚­ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„
- APIä½¿ç”¨åˆ¶é™ã«é”ã—ã¦ã„ã‚‹
- è«‹æ±‚æƒ…å ±ãŒæ­£ã—ããªã„

**ğŸ”§ è§£æ±ºæ³•ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šAPIã‚­ãƒ¼ã®ç¢ºèª**
```bash
# ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
echo $OPENAI_API_KEY

# .envãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
cat .env | grep OPENAI_API_KEY
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šAPIåˆ¶é™ã®ç¢ºèª**
```python
# APIåˆ¶é™ã®è©³ç´°ç¢ºèª
import openai
from datetime import datetime

try:
    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
        messages=[{"role": "user", "content": "Hello"}],
        max_tokens=10
    )
    print("APIæ¥ç¶šOK")
except openai.error.RateLimitError as e:
    print(f"ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¨ãƒ©ãƒ¼: {e}")
    print("ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„")
except openai.error.AuthenticationError as e:
    print(f"èªè¨¼ã‚¨ãƒ©ãƒ¼: {e}")
    print("APIã‚­ãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„")
except Exception as e:
    print(f"ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼: {e}")
```

**ã‚¹ãƒ†ãƒƒãƒ—3ï¼šä½¿ç”¨é‡ã®ç›£è¦–**
```python
# ä½¿ç”¨é‡ç›£è¦–æ©Ÿèƒ½
import time
from functools import wraps

def rate_limit_wrapper(max_calls=10, time_window=60):
    calls = []
    
    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            now = time.time()
            # å¤ã„å‘¼ã³å‡ºã—ã‚’å‰Šé™¤
            calls[:] = [call for call in calls if now - call < time_window]
            
            if len(calls) >= max_calls:
                wait_time = time_window - (now - calls[0])
                print(f"{wait_time:.1f}ç§’å¾…æ©Ÿä¸­...")
                time.sleep(wait_time)
            
            calls.append(now)
            return func(*args, **kwargs)
        return wrapper
    return decorator

@rate_limit_wrapper(max_calls=5, time_window=60)
def call_openai_api(prompt):
    # APIå‘¼ã³å‡ºã—
    pass
```

**ğŸš¨ äºˆé˜²ç­–ï¼š**
- APIä½¿ç”¨é‡ã®å®šæœŸçš„ãªç›£è¦–
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®å®Ÿè£…
- è«‹æ±‚ã‚¢ãƒ©ãƒ¼ãƒˆã®è¨­å®š

#### ğŸ—‚ï¸ 3. ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼

**ğŸš¨ ã‚¨ãƒ©ãƒ¼ä¾‹ï¼š**
```bash
FileNotFoundError: vector_store directory not found
RuntimeError: FAISS index is empty
ValueError: No documents found in knowledge directory
```

**ğŸ’¡ åŸå› ï¼š**
- ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ãŒæ­£ã—ãæ§‹ç¯‰ã•ã‚Œã¦ã„ãªã„
- knowledgeãƒ•ã‚©ãƒ«ãƒ€ãŒç©º
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®å•é¡Œ

**ğŸ”§ è§£æ±ºæ³•ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ç¢ºèª**
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ç¢ºèª
ls -la
# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼šknowledge/, vector_store/

# ãƒŠãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
ls -la knowledge/
# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼š*.md ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã®å†æ§‹ç¯‰**
```bash
# æ—¢å­˜ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã‚’å‰Šé™¤
rm -rf vector_store/

# å†æ§‹ç¯‰
python3 run_etl.py
```

**ã‚¹ãƒ†ãƒƒãƒ—3ï¼šè©³ç´°ãªãƒ‡ãƒãƒƒã‚°**
```python
# run_etl.py ã«ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ã‚’è¿½åŠ 
import os
import glob

def debug_knowledge_loading():
    knowledge_dir = "knowledge"
    
    # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å­˜åœ¨ç¢ºèª
    if not os.path.exists(knowledge_dir):
        print(f"âŒ {knowledge_dir} ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ã¾ã›ã‚“")
        return False
    
    # ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
    md_files = glob.glob(f"{knowledge_dir}/*.md")
    print(f"ğŸ“ ç™ºè¦‹ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«æ•°: {len(md_files)}")
    
    for file in md_files:
        size = os.path.getsize(file)
        print(f"ğŸ“„ {file}: {size} bytes")
        
        # å†…å®¹ã®ç¢ºèª
        with open(file, 'r', encoding='utf-8') as f:
            content = f.read()
            print(f"   å†…å®¹: {content[:100]}...")
    
    return len(md_files) > 0

# ãƒ‡ãƒãƒƒã‚°å®Ÿè¡Œ
if __name__ == "__main__":
    debug_knowledge_loading()
```

**ğŸš¨ äºˆé˜²ç­–ï¼š**
- å®šæœŸçš„ãªãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚ã®è‡ªå‹•å†æ§‹ç¯‰
- æ¨©é™è¨­å®šã®ç¢ºèª

#### ğŸŒ 4. ãƒãƒ¼ãƒˆç«¶åˆã‚¨ãƒ©ãƒ¼

**ğŸš¨ ã‚¨ãƒ©ãƒ¼ä¾‹ï¼š**
```bash
ERROR: [Errno 48] Address already in use
OSError: [Errno 98] Address already in use
```

**ğŸ’¡ åŸå› ï¼š**
- æ—¢ã«åŒã˜ãƒãƒ¼ãƒˆã§ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹
- å‰å›ã®ã‚µãƒ¼ãƒãƒ¼ãŒæ­£ã—ãçµ‚äº†ã—ã¦ã„ãªã„
- ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ä¸­

**ğŸ”§ è§£æ±ºæ³•ï¼š**

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒãƒ¼ãƒˆä½¿ç”¨çŠ¶æ³ã®ç¢ºèª**
```bash
# ãƒãƒ¼ãƒˆ8000ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºèª
lsof -ti:8000
# ã¾ãŸã¯
netstat -tlnp | grep :8000
```

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šãƒ—ãƒ­ã‚»ã‚¹ã®çµ‚äº†**
```bash
# ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
kill -9 $(lsof -ti:8000)

# å…¨ã¦ã®Pythonãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºèª
ps aux | grep python
```

**ã‚¹ãƒ†ãƒƒãƒ—3ï¼šä»£æ›¿ãƒãƒ¼ãƒˆã®ä½¿ç”¨**
```bash
# ç•°ãªã‚‹ãƒãƒ¼ãƒˆã§èµ·å‹•
export PORT=8080
python3 server.py

# ã¾ãŸã¯ç›´æ¥æŒ‡å®š
uvicorn server:app --port 8080
```

**ğŸ”§ è‡ªå‹•çš„ãªè§£æ±ºæ–¹æ³•ï¼š**
```python
# server.py ã«è‡ªå‹•ãƒãƒ¼ãƒˆæ¤œå‡ºæ©Ÿèƒ½ã‚’è¿½åŠ 
import socket
import uvicorn

def find_free_port(start_port=8000, max_port=8100):
    """åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ãƒˆã‚’è¦‹ã¤ã‘ã‚‹"""
    for port in range(start_port, max_port):
        try:
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
                s.bind(('localhost', port))
                return port
        except OSError:
            continue
    raise RuntimeError("åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")

if __name__ == "__main__":
    port = find_free_port()
    print(f"ğŸš€ ã‚µãƒ¼ãƒãƒ¼ã‚’ãƒãƒ¼ãƒˆ {port} ã§èµ·å‹•ã—ã¾ã™")
    uvicorn.run(app, host="0.0.0.0", port=port)
```

**ğŸš¨ äºˆé˜²ç­–ï¼š**
- ã‚µãƒ¼ãƒãƒ¼çµ‚äº†æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- é–‹ç™ºç’°å¢ƒã§ã®å°‚ç”¨ãƒãƒ¼ãƒˆä½¿ç”¨
- Dockerä½¿ç”¨æ™‚ã®ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®š

### ğŸ” ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

#### ğŸ“Š 1. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã®å¤‰æ›´

**ğŸ¯ ãªãœãƒ­ã‚°ãŒé‡è¦ï¼Ÿ**
- å•é¡Œã®åŸå› ã‚’ç‰¹å®š
- ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œçŠ¶æ³ã‚’æŠŠæ¡
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ç›£è¦–

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

**ğŸ“ åŒ…æ‹¬çš„ãªãƒ­ã‚°è¨­å®šï¼š**
```python
import logging
import sys
from datetime import datetime

# ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®è¨­å®š
log_format = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
logging.basicConfig(
    level=logging.INFO,
    format=log_format,
    handlers=[
        logging.FileHandler('rag_server.log'),
        logging.StreamHandler(sys.stdout)
    ]
)

# å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«è¨­å®š
logging.getLogger('uvicorn').setLevel(logging.INFO)
logging.getLogger('openai').setLevel(logging.WARNING)
logging.getLogger('faiss').setLevel(logging.ERROR)

logger = logging.getLogger(__name__)

# ä½¿ç”¨ä¾‹
@app.middleware("http")
async def log_requests(request: Request, call_next):
    start_time = datetime.now()
    
    logger.info(f"Request: {request.method} {request.url}")
    
    response = await call_next(request)
    
    process_time = (datetime.now() - start_time).total_seconds()
    logger.info(f"Response: {response.status_code} ({process_time:.2f}s)")
    
    return response
```

#### ğŸ” 2. æ¤œç´¢çµæœã®ç¢ºèª

**ğŸ¯ ãªãœæ¤œç´¢çµæœã®ç¢ºèªãŒé‡è¦ï¼Ÿ**
- é–¢é€£æ€§ã®ä½ã„æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ãªã„ã‹
- æ¤œç´¢ç²¾åº¦ã®è©•ä¾¡
- ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŠ¹æœæ¸¬å®š

```python
def debug_retrieval(query: str):
    docs = vector_store.similarity_search(query, k=3)
    for i, doc in enumerate(docs):
        print(f"Document {i}: {doc.page_content[:100]}...")
```

**ğŸ“ è©³ç´°ãªãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ï¼š**
```python
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity

def advanced_debug_retrieval(query: str, k: int = 5):
    """é«˜åº¦ãªæ¤œç´¢çµæœãƒ‡ãƒãƒƒã‚°"""
    
    # æ¤œç´¢å®Ÿè¡Œ
    docs_with_scores = vector_store.similarity_search_with_score(query, k=k)
    
    print(f"ğŸ” æ¤œç´¢ã‚¯ã‚¨ãƒª: {query}")
    print(f"ğŸ“Š æ¤œç´¢çµæœæ•°: {len(docs_with_scores)}")
    print("=" * 50)
    
    for i, (doc, score) in enumerate(docs_with_scores):
        print(f"ğŸ“„ æ–‡æ›¸ {i+1} (ã‚¹ã‚³ã‚¢: {score:.4f})")
        print(f"ğŸ“ å†…å®¹: {doc.page_content[:200]}...")
        print(f"ğŸ·ï¸  ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿: {doc.metadata}")
        print("-" * 30)
    
    # ã‚¹ã‚³ã‚¢åˆ†æ
    scores = [score for _, score in docs_with_scores]
    print(f"ğŸ“ˆ ã‚¹ã‚³ã‚¢çµ±è¨ˆ:")
    print(f"   æœ€é«˜: {max(scores):.4f}")
    print(f"   æœ€ä½: {min(scores):.4f}")
    print(f"   å¹³å‡: {np.mean(scores):.4f}")
    print(f"   æ¨™æº–åå·®: {np.std(scores):.4f}")
    
    return docs_with_scores

# ã‚ˆã‚Šè©³ç´°ãªåˆ†æ
def analyze_search_quality(query: str, expected_keywords: list):
    """æ¤œç´¢å“è³ªã®åˆ†æ"""
    docs = vector_store.similarity_search(query, k=10)
    
    keyword_hits = {keyword: 0 for keyword in expected_keywords}
    
    for doc in docs:
        content = doc.page_content.lower()
        for keyword in expected_keywords:
            if keyword.lower() in content:
                keyword_hits[keyword] += 1
    
    print(f"ğŸ¯ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºçµæœ:")
    for keyword, hits in keyword_hits.items():
        print(f"   {keyword}: {hits}/10 æ–‡æ›¸")
    
    return keyword_hits
```

#### ğŸ­ 3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ¤œè¨¼

**ğŸ¯ ãªãœãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ¤œè¨¼ãŒé‡è¦ï¼Ÿ**
- æ„å›³ã—ãªã„å›ç­”ã®åŸå› ç‰¹å®š
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ”¹å–„ãƒã‚¤ãƒ³ãƒˆç™ºè¦‹
- A/Bãƒ†ã‚¹ãƒˆã®å®Ÿæ–½

```python
def debug_prompt(query: str):
    prompt = get_dynamic_prompt_template(query)
    print(f"Generated prompt: {prompt}")
```

**ğŸ“ é«˜åº¦ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ‡ãƒãƒƒã‚°ï¼š**
```python
def comprehensive_prompt_debug(query: str):
    """åŒ…æ‹¬çš„ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ‡ãƒãƒƒã‚°"""
    
    # è¨€èªæ¤œå‡º
    detected_lang = detect_language(query)
    print(f"ğŸŒ æ¤œå‡ºè¨€èª: {detected_lang}")
    
    # æ¤œç´¢å®Ÿè¡Œ
    docs = vector_store.similarity_search(query, k=5)
    context = "\n".join([doc.page_content for doc in docs])
    
    # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
    prompt_template = get_dynamic_prompt_template(query)
    final_prompt = prompt_template.format(context=context, question=query)
    
    print(f"ğŸ“ æœ€çµ‚ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:")
    print("=" * 50)
    print(final_prompt)
    print("=" * 50)
    
    # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆ†æ
    prompt_length = len(final_prompt)
    context_length = len(context)
    
    print(f"ğŸ“Š ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆçµ±è¨ˆ:")
    print(f"   å…¨é•·: {prompt_length} æ–‡å­—")
    print(f"   ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ: {context_length} æ–‡å­—")
    print(f"   è³ªå•: {len(query)} æ–‡å­—")
    print(f"   ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ: {prompt_length - context_length - len(query)} æ–‡å­—")
    
    return final_prompt

# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆA/Bãƒ†ã‚¹ãƒˆ
def prompt_ab_test(query: str, prompt_a: str, prompt_b: str):
    """ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆA/Bãƒ†ã‚¹ãƒˆ"""
    
    results = {}
    
    for name, prompt in [("A", prompt_a), ("B", prompt_b)]:
        print(f"ğŸ§ª ãƒ†ã‚¹ãƒˆ {name}:")
        
        # å®Ÿéš›ã«LLMã‚’å‘¼ã³å‡ºã—ã¦æ¯”è¼ƒ
        # response = llm.invoke(prompt)
        # results[name] = response
        
        print(f"   ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé•·: {len(prompt)}")
        print(f"   ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: {prompt[:100]}...")
        print("-" * 30)
    
    return results
```

**ğŸ¯ å®Ÿè·µçš„ãªãƒ‡ãƒãƒƒã‚°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼š**
1. **ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ç¢ºèª** â†’ å•é¡Œã®ç‰¹å®š
2. **æ¤œç´¢çµæœã®åˆ†æ** â†’ é–¢é€£æ€§ã®è©•ä¾¡
3. **ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ¤œè¨¼** â†’ æŒ‡ç¤ºã®æ˜ç¢ºã•ç¢ºèª
4. **è¨­å®šã®èª¿æ•´** â†’ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„
5. **å†ãƒ†ã‚¹ãƒˆ** â†’ æ”¹å–„åŠ¹æœã®ç¢ºèª

---

## ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°ï¼šã‚ãªãŸã®ç•ªã§ã™

### ğŸ‰ ãŠã‚ã§ã¨ã†ï¼

å¤ªéƒã¯ã€ã¤ã„ã«è‡ªåˆ†ã ã‘ã®ã€ŒAIãŠã°ã‚ã¡ã‚ƒã‚“ã€ã‚’ä½œã‚‹ã“ã¨ãŒã§ããŸã€‚

ã€Œã™ã”ã„ã˜ã‚ƒãªã„ã€å¤ªéƒãã‚“ï¼ã€AIãŠã°ã‚ã¡ã‚ƒã‚“ãŒå¾®ç¬‘ã‚“ã ã€‚ã€Œã“ã‚Œã§ã€ã‚ãªãŸã‚‚ç«‹æ´¾ãªRAGã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã­ã€‚ã€

### ğŸŒŸ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

**1. è‡ªåˆ†ã ã‘ã®çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‚’ä½œã‚‹**
- è¶£å‘³ã®çŸ¥è­˜ï¼ˆéŸ³æ¥½ã€ã‚¹ãƒãƒ¼ãƒ„ã€ã‚²ãƒ¼ãƒ ï¼‰
- ä»•äº‹ã®çŸ¥è­˜ï¼ˆæ¥­ç•Œæƒ…å ±ã€æŠ€è¡“æ–‡æ›¸ï¼‰
- å­¦ç¿’ãƒãƒ¼ãƒˆï¼ˆæˆæ¥­å†…å®¹ã€å‚è€ƒæ›¸ã®è¦ç´„ï¼‰

**2. æ©Ÿèƒ½ã‚’æ‹¡å¼µã™ã‚‹**
- ç”»åƒèªè­˜æ©Ÿèƒ½ã®è¿½åŠ 
- éŸ³å£°å…¥åŠ›å¯¾å¿œ
- å¤šè¨€èªå¯¾å¿œã®å¼·åŒ–
- ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã‚¢ãƒ—ãƒªåŒ–

**3. ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«å‚åŠ ã™ã‚‹**
- GitHub ã§ã‚³ãƒ¼ãƒ‰ã‚’å…¬é–‹
- ãƒ–ãƒ­ã‚°ã§å­¦ç¿’è¨˜éŒ²ã‚’ç™ºä¿¡
- å‹‰å¼·ä¼šã‚„ãƒãƒƒã‚«ã‚½ãƒ³ã«å‚åŠ 

### ğŸ’ æœ€å¾Œã«

RAGã¯ã€AIã«ã€Œå°‚é–€çŸ¥è­˜ã€ã‚’æŒãŸã›ã‚‹é­”æ³•ã®æŠ€è¡“ã€‚ã§ã‚‚ã€æœ¬å½“ã®é­”æ³•ã¯ã€ã‚ãªãŸè‡ªèº«ã®å‰µé€ åŠ›ã¨ã‚¢ã‚¤ãƒ‡ã‚¢ã€‚

ä»Šæ—¥å­¦ã‚“ã ã“ã¨ã‚’æ´»ã‹ã—ã¦ã€ä¸–ç•Œã‚’ã¡ã‚‡ã£ã¨ä¾¿åˆ©ã«ã™ã‚‹ã€ã‚ãªãŸã ã‘ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ä½œã£ã¦ã¿ã¦ãã ã•ã„ã€‚

**ã€Œã•ã‚ã€ã‚ãªãŸã®ç•ªã‚ˆã€‚ã©ã‚“ãªAIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ä½œã‚‹ã®ï¼Ÿã€**

---

## ğŸ”— å‚è€ƒè³‡æ–™

### ğŸ“š æŠ€è¡“ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

- **LangChainå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://python.langchain.com/
- **FastAPIå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://fastapi.tiangolo.com/
- **OpenAI API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**: https://platform.openai.com/docs
- **FAISS GitHub**: https://github.com/facebookresearch/faiss

### ğŸ› ï¸ é–‹ç™ºãƒ„ãƒ¼ãƒ«

- **Visual Studio Code**: https://code.visualstudio.com/
- **GitHub Desktop**: https://desktop.github.com/
- **Docker**: https://www.docker.com/
- **Postman**: https://www.postman.com/

### ğŸ“ å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- **æ©Ÿæ¢°å­¦ç¿’ Coursera**: https://www.coursera.org/learn/machine-learning
- **Deep Learning Specialization**: https://www.coursera.org/specializations/deep-learning
- **Python.org ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«**: https://docs.python.org/3/tutorial/

### ğŸŒ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£

- **Reddit - r/MachineLearning**: https://www.reddit.com/r/MachineLearning/
- **Stack Overflow**: https://stackoverflow.com/questions/tagged/langchain
- **Discord - AI/ML ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£**: å„ç¨®ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ 

---

## ğŸ·ï¸ ã‚¿ã‚°

`#RAG` `#AI` `#ChatBot` `#Python` `#FastAPI` `#LangChain` `#OpenAI` `#åˆå¿ƒè€…` `#ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«` `#æ©Ÿæ¢°å­¦ç¿’` `#è‡ªç„¶è¨€èªå‡¦ç†` `#ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢` `#çŸ¥è­˜ãƒ™ãƒ¼ã‚¹` `#ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å­¦ç¿’`

---

*ã“ã®è¨˜äº‹ãŒå½¹ã«ç«‹ã£ãŸã‚‰ã€ãœã²â­ã‚’ã¤ã‘ã¦ã€å‹é”ã«ã‚‚ã‚·ã‚§ã‚¢ã—ã¦ãã ã•ã„ï¼*

**ğŸš€ [RAG Starter Kit ã‚’GitHubã§è¦‹ã‚‹](https://github.com/takusaotome/rag-starter-kit)**

---

*æœ€çµ‚æ›´æ–°æ—¥: 2025å¹´7æœˆ*
*åŸ·ç­†è€…: AI ã¨äººé–“ã®ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³*
*ãƒ©ã‚¤ã‚»ãƒ³ã‚¹: MIT License* 